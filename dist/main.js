(()=>{var t={456:t=>{"use strict";t.exports=function t(e){return null===e||"object"!=typeof e||null!=e.toJSON?JSON.stringify(e):Array.isArray(e)?"["+e.reduce(((e,r,i)=>e+(0===i?"":",")+t(void 0===r||"symbol"==typeof r?null:r)),"")+"]":"{"+Object.keys(e).sort().reduce(((r,i,n)=>void 0===e[i]||"symbol"==typeof e[i]?r:r+(0===r.length?"":",")+t(i)+":"+t(e[i])),"")+"}"}},905:function(){!function(t){!function(e){var r="URLSearchParams"in t,i="Symbol"in t&&"iterator"in Symbol,n="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),a="FormData"in t,s="ArrayBuffer"in t;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(t){return t&&o.indexOf(Object.prototype.toString.call(t))>-1};function d(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function c(t){return"string"!=typeof t&&(t=String(t)),t}function u(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return i&&(e[Symbol.iterator]=function(){return e}),e}function h(t){this.map={},t instanceof h?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function f(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function g(t){var e=new FileReader,r=p(e);return e.readAsArrayBuffer(t),r}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:n&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:a&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&n&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||l(t))?this._bodyArrayBuffer=y(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n&&(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var t,e,r,i=f(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,r=p(e=new FileReader),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),i=0;i<e.length;i++)r[i]=String.fromCharCode(e[i]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(t,e){t=d(t),e=c(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},h.prototype.delete=function(t){delete this.map[d(t)]},h.prototype.get=function(t){return t=d(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(d(t))},h.prototype.set=function(t,e){this.map[d(t)]=c(e)},h.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},h.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),u(t)},h.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),u(t)},h.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),u(t)},i&&(h.prototype[Symbol.iterator]=h.prototype.entries);var C=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){var r,i,n=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new h(e.headers)),this.method=(i=(r=e.method||this.method||"GET").toUpperCase(),C.indexOf(i)>-1?i:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function _(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),i=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(n))}})),e}function I(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new h(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},E.call(w.prototype),E.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},I.error=function(){var t=new I(null,{status:0,statusText:""});return t.type="error",t};var R=[301,302,303,307,308];I.redirect=function(t,e){if(-1===R.indexOf(e))throw new RangeError("Invalid status code");return new I(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function O(t,r){return new Promise((function(i,a){var s=new w(t,r);if(s.signal&&s.signal.aborted)return a(new e.DOMException("Aborted","AbortError"));var o=new XMLHttpRequest;function l(){o.abort()}o.onload=function(){var t,e,r={status:o.status,statusText:o.statusText,headers:(t=o.getAllResponseHeaders()||"",e=new h,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=t.split(":"),i=r.shift().trim();if(i){var n=r.join(":").trim();e.append(i,n)}})),e)};r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var n="response"in o?o.response:o.responseText;i(new I(n,r))},o.onerror=function(){a(new TypeError("Network request failed"))},o.ontimeout=function(){a(new TypeError("Network request failed"))},o.onabort=function(){a(new e.DOMException("Aborted","AbortError"))},o.open(s.method,s.url,!0),"include"===s.credentials?o.withCredentials=!0:"omit"===s.credentials&&(o.withCredentials=!1),"responseType"in o&&n&&(o.responseType="blob"),s.headers.forEach((function(t,e){o.setRequestHeader(e,t)})),s.signal&&(s.signal.addEventListener("abort",l),o.onreadystatechange=function(){4===o.readyState&&s.signal.removeEventListener("abort",l)}),o.send(void 0===s._bodyInit?null:s._bodyInit)}))}O.polyfill=!0,t.fetch||(t.fetch=O,t.Headers=h,t.Request=w,t.Response=I),e.Headers=h,e.Request=w,e.Response=I,e.fetch=O}({})}("undefined"!=typeof self?self:this)},624:t=>{function e(t){if(t)return function(t){for(var r in e.prototype)t[r]=e.prototype[r];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},e.prototype.once=function(t,e){var r=this;function i(){r.off(t,i),e.apply(this,arguments)}return this._callbacks=this._callbacks||{},i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,i=this._callbacks[t];if(!i)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var n=0;n<i.length;n++)if((r=i[n])===e||r.fn===e){i.splice(n,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r)for(var i=0,n=(r=r.slice(0)).length;i<n;++i)r[i].apply(this,e);return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},475:t=>{"use strict";var e=/^utf-?8|ascii|utf-?16-?le|ucs-?2|base-?64|latin-?1$/i,r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,i=/\s|\uFEFF|\xA0/,n=/\r?\n[\x20\x09]+/g,a=/[;,"]/,s=/[;,"]|\s/,o=/^[!#$%&'*+\-\.^_`|~\da-zA-Z]+$/;function l(t){return t.replace(r,"")}function d(t){return i.test(t)}function c(t,e){for(;d(t[e]);)e++;return e}function u(t){return s.test(t)||!o.test(t)}class h{constructor(t){this.refs=[],t&&this.parse(t)}rel(t){for(var e=[],r=t.toLowerCase(),i=0;i<this.refs.length;i++)this.refs[i].rel.toLowerCase()===r&&e.push(this.refs[i]);return e}get(t,e){t=t.toLowerCase();for(var r=[],i=0;i<this.refs.length;i++)this.refs[i][t]===e&&r.push(this.refs[i]);return r}set(t){return this.refs.push(t),this}has(t,e){t=t.toLowerCase();for(var r=0;r<this.refs.length;r++)if(this.refs[r][t]===e)return!0;return!1}parse(t,e){for(var r=1,i=(t=l(t=(e=e||0)?t.slice(e):t).replace(n,"")).length,s=(e=0,null);e<i;)if(1===r){if(d(t[e])){e++;continue}if("<"!==t[e])throw new Error('Unexpected character "'+t[e]+'" at offset '+e);if(null!=s&&(null!=s.rel?this.refs.push(...h.expandRelations(s)):this.refs.push(s)),-1===(f=t.indexOf(">",e)))throw new Error("Expected end of URI delimiter at offset "+e);s={uri:t.slice(e+1,f)},e=f,r=2,e++}else if(2===r){if(d(t[e])){e++;continue}if(";"===t[e])r=4,e++;else{if(","!==t[e])throw new Error('Unexpected character "'+t[e]+'" at offset '+e);r=1,e++}}else{if(4!==r)throw new Error('Unknown parser state "'+r+'"');if(";"===t[e]||d(t[e])){e++;continue}if(-1===(f=t.indexOf("=",e)))throw new Error("Expected attribute delimiter at offset "+e);var o=l(t.slice(e,f)).toLowerCase(),u="";if('"'===t[e=c(t,e=f+1)])for(e++;e<i;){if('"'===t[e]){e++;break}"\\"===t[e]&&e++,u+=t[e],e++}else{for(var f=e+1;!a.test(t[f])&&f<i;)f++;u=t.slice(e,f),e=f}switch(s[o]&&h.isSingleOccurenceAttr(o)||("*"===o[o.length-1]?s[o]=h.parseExtendedValue(u):(u="type"===o?u.toLowerCase():u,null!=s[o]?Array.isArray(s[o])?s[o].push(u):s[o]=[s[o],u]:s[o]=u)),t[e]){case",":r=1;break;case";":r=4}e++}return null!=s&&(null!=s.rel?this.refs.push(...h.expandRelations(s)):this.refs.push(s)),s=null,this}toString(){for(var t=[],e="",r=null,i=0;i<this.refs.length;i++)r=this.refs[i],e=Object.keys(this.refs[i]).reduce((function(t,e){return"uri"===e?t:t+"; "+h.formatAttribute(e,r[e])}),"<"+r.uri+">"),t.push(e);return t.join(", ")}}h.isCompatibleEncoding=function(t){return e.test(t)},h.parse=function(t,e){return(new h).parse(t,e)},h.isSingleOccurenceAttr=function(t){return"rel"===t||"type"===t||"media"===t||"title"===t||"title*"===t},h.isTokenAttr=function(t){return"rel"===t||"type"===t||"anchor"===t},h.escapeQuotes=function(t){return t.replace(/"/g,'\\"')},h.expandRelations=function(t){return t.rel.split(" ").map((function(e){var r=Object.assign({},t);return r.rel=e,r}))},h.parseExtendedValue=function(t){var e=/([^']+)?(?:'([^']+)')?(.+)/.exec(t);return{language:e[2].toLowerCase(),encoding:h.isCompatibleEncoding(e[1])?null:e[1].toLowerCase(),value:h.isCompatibleEncoding(e[1])?decodeURIComponent(e[3]):e[3]}},h.formatExtendedAttribute=function(t,e){var r=(e.encoding||"utf-8").toUpperCase();return t+"="+r+"'"+(e.language||"en")+"'"+(Buffer.isBuffer(e.value)&&h.isCompatibleEncoding(r)?e.value.toString(r):Buffer.isBuffer(e.value)?e.value.toString("hex").replace(/[0-9a-f]{2}/gi,"%$1"):encodeURIComponent(e.value))},h.formatAttribute=function(t,e){return Array.isArray(e)?e.map((e=>h.formatAttribute(t,e))).join("; "):"*"===t[t.length-1]||"string"!=typeof e?h.formatExtendedAttribute(t,e):(h.isTokenAttr(t)?e=u(e)?'"'+h.escapeQuotes(e)+'"':h.escapeQuotes(e):u(e)&&(e='"'+(e=(e=encodeURIComponent(e)).replace(/%20/g," ").replace(/%2C/g,",").replace(/%3B/g,";"))+'"'),t+"="+e)},t.exports=h},288:function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||i(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(r(931),e),n(r(11),e),n(r(378),e),n(r(891),e),n(r(0),e),n(r(656),e),n(r(990),e)},931:function(t,e,r){"use strict";var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))((function(n,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,o)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultExpandOptions=e.ContextParser=void 0,r(905);const n=r(912),a=r(11),s=r(378),o=r(656),l=r(990),d=r(456);class c{constructor(t){t=t||{},this.documentLoader=t.documentLoader||new s.FetchDocumentLoader,this.documentCache={},this.validateContext=!t.skipValidation,this.expandContentTypeToBase=!!t.expandContentTypeToBase,this.remoteContextsDepthLimit=t.remoteContextsDepthLimit||32,this.redirectSchemaOrgHttps=!("redirectSchemaOrgHttps"in t)||!!t.redirectSchemaOrgHttps}static validateLanguage(t,e,r){if("string"!=typeof t)throw new a.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(t)}'`,r);if(!l.Util.REGEX_LANGUAGE_TAG.test(t)){if(e)throw new a.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(t)}'`,r);return!1}return!0}static validateDirection(t,e){if("string"!=typeof t)throw new a.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(t)}'`,a.ERROR_CODES.INVALID_BASE_DIRECTION);if(!l.Util.REGEX_DIRECTION_TAG.test(t)){if(e)throw new a.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(t)}'`,a.ERROR_CODES.INVALID_BASE_DIRECTION);return!1}return!0}idifyReverseTerms(t){for(const e of Object.keys(t)){const r=t[e];if(r&&"object"==typeof r&&r["@reverse"]&&!r["@id"]){if("string"!=typeof r["@reverse"]||l.Util.isValidKeyword(r["@reverse"]))throw new a.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${r["@reverse"]}'`,a.ERROR_CODES.INVALID_IRI_MAPPING);r["@id"]=r["@reverse"],l.Util.isPotentialKeyword(r["@reverse"])?delete r["@reverse"]:r["@reverse"]=!0}}return t}expandPrefixedTerms(t,e){const r=t.getContextRaw();for(const i of Object.keys(r))if(l.Util.EXPAND_KEYS_BLACKLIST.indexOf(i)<0&&!l.Util.isReservedInternalKeyword(i)){const n=r[i];if(l.Util.isPotentialKeyword(i)&&l.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(i)>=0&&("@type"!==i||"object"==typeof r[i]&&!r[i]["@protected"]&&"@set"!==r[i]["@container"]))throw new a.ErrorCoded(`Keywords can not be aliased to something else.\nTried mapping ${i} to ${JSON.stringify(n)}`,a.ERROR_CODES.KEYWORD_REDEFINITION);if(l.Util.ALIAS_RANGE_BLACKLIST.indexOf(l.Util.getContextValueId(n))>=0)throw new a.ErrorCoded(`Aliasing to certain keywords is not allowed.\nTried mapping ${i} to ${JSON.stringify(n)}`,a.ERROR_CODES.INVALID_KEYWORD_ALIAS);if(n&&l.Util.isPotentialKeyword(l.Util.getContextValueId(n))&&!0===n["@prefix"])throw new a.ErrorCoded(`Tried to use keyword aliases as prefix: '${i}': '${JSON.stringify(n)}'`,a.ERROR_CODES.INVALID_TERM_DEFINITION);for(;l.Util.isPrefixValue(r[i]);){const n=r[i];let a=!1;if("string"==typeof n)r[i]=t.expandTerm(n,!0),a=a||n!==r[i];else{const s=n["@id"],o=n["@type"],d=!("@prefix"in n)||l.Util.isValidIri(i);if("@id"in n)null!=s&&"string"==typeof s&&(r[i]["@id"]=t.expandTerm(s,!0),a=a||s!==r[i]["@id"]);else if(!l.Util.isPotentialKeyword(i)&&d){const e=t.expandTerm(i,!0);e!==i&&(r[i]["@id"]=e,a=!0)}!o||"string"!=typeof o||"@vocab"===o||n["@container"]&&n["@container"]["@type"]||!d||(r[i]["@type"]=t.expandTerm(o,!0),e&&o===r[i]["@type"]&&(r[i]["@type"]=t.expandTerm(o,!1)),a=a||o!==r[i]["@type"])}if(!a)break}}}normalize(t,{processingMode:e,normalizeLanguageTags:r}){if(r||1===e)for(const e of Object.keys(t))if("@language"===e&&"string"==typeof t[e])t[e]=t[e].toLowerCase();else{const r=t[e];r&&"object"==typeof r&&"string"==typeof r["@language"]&&(r["@language"]=r["@language"].toLowerCase())}}containersToHash(t){for(const e of Object.keys(t)){const r=t[e];if(r&&"object"==typeof r)if("string"==typeof r["@container"])r["@container"]={[r["@container"]]:!0};else if(Array.isArray(r["@container"])){const t={};for(const e of r["@container"])t[e]=!0;r["@container"]=t}}}applyScopedProtected(t,{processingMode:e}){if(e&&e>=1.1&&t["@protected"]){for(const e of Object.keys(t))if(!l.Util.isReservedInternalKeyword(e)&&!l.Util.isPotentialKeyword(e)&&!l.Util.isTermProtected(t,e)){const r=t[e];r&&"object"==typeof r?"@protected"in t[e]||(t[e]["@protected"]=!0):t[e]={"@id":r,"@protected":!0}}delete t["@protected"]}}validateKeywordRedefinitions(t,e,r){for(const i of Object.keys(e))if(l.Util.isTermProtected(t,i)){if("string"==typeof e[i]){const n=l.Util.isSimpleTermDefinitionPrefix(e[i],r);e[i]={"@id":e[i]},n&&(e[i]["@prefix"]=!0,t[i]["@prefix"]=!0)}const n=d(t[i]);if(e[i]["@protected"]=!0,n!==d(e[i]))throw new a.ErrorCoded(`Attempted to override the protected keyword ${i} from ${JSON.stringify(l.Util.getContextValueId(t[i]))} to ${JSON.stringify(l.Util.getContextValueId(e[i]))}`,a.ERROR_CODES.PROTECTED_TERM_REDEFINITION)}}validate(t,{processingMode:e}){for(const r of Object.keys(t)){if(l.Util.isReservedInternalKeyword(r))continue;if(""===r)throw new a.ErrorCoded(`The empty term is not allowed, got: '${r}': '${JSON.stringify(t[r])}'`,a.ERROR_CODES.INVALID_TERM_DEFINITION);const i=t[r],n=typeof i;if(l.Util.isPotentialKeyword(r)){switch(r.substr(1)){case"vocab":if(null!==i&&"string"!==n)throw new a.ErrorCoded(`Found an invalid @vocab IRI: ${i}`,a.ERROR_CODES.INVALID_VOCAB_MAPPING);break;case"base":if(null!==i&&"string"!==n)throw new a.ErrorCoded(`Found an invalid @base IRI: ${t[r]}`,a.ERROR_CODES.INVALID_BASE_IRI);break;case"language":null!==i&&c.validateLanguage(i,!0,a.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);break;case"version":if(null!==i&&"number"!==n)throw new a.ErrorCoded(`Found an invalid @version number: ${i}`,a.ERROR_CODES.INVALID_VERSION_VALUE);break;case"direction":null!==i&&c.validateDirection(i,!0);break;case"propagate":if(1===e)throw new a.ErrorCoded(`Found an illegal @propagate keyword: ${i}`,a.ERROR_CODES.INVALID_CONTEXT_ENTRY);if(null!==i&&"boolean"!==n)throw new a.ErrorCoded(`Found an invalid @propagate value: ${i}`,a.ERROR_CODES.INVALID_PROPAGATE_VALUE)}if(l.Util.isValidKeyword(r)&&l.Util.isValidKeyword(l.Util.getContextValueId(i)))throw new a.ErrorCoded(`Illegal keyword alias in term value, found: '${r}': '${l.Util.getContextValueId(i)}'`,a.ERROR_CODES.KEYWORD_REDEFINITION)}else if(null!==i)switch(n){case"string":if(l.Util.getPrefix(i,t)===r)throw new a.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.CYCLIC_IRI_MAPPING);if(l.Util.isValidIriWeak(r)){if("@type"===i)throw new a.ErrorCoded(`IRIs can not be mapped to @type, found: '${r}': '${i}'`,a.ERROR_CODES.INVALID_IRI_MAPPING);if(l.Util.isValidIri(i)&&i!==new o.JsonLdContextNormalized(t).expandTerm(r))throw new a.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${r}': '${i}'`,a.ERROR_CODES.INVALID_IRI_MAPPING)}break;case"object":if(!(l.Util.isCompactIri(r)||"@id"in i||("@id"===i["@type"]?t["@base"]:t["@vocab"])))throw new a.ErrorCoded(`Missing @id in context entry: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_IRI_MAPPING);for(const s of Object.keys(i)){const d=i[s];if(d)switch(s){case"@id":if(l.Util.isValidKeyword(d)&&"@type"!==d&&"@id"!==d&&"@graph"!==d)throw new a.ErrorCoded(`Illegal keyword alias in term value, found: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_IRI_MAPPING);if(l.Util.isValidIriWeak(r)){if("@type"===d)throw new a.ErrorCoded(`IRIs can not be mapped to @type, found: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_IRI_MAPPING);if(l.Util.isValidIri(d)&&d!==new o.JsonLdContextNormalized(t).expandTerm(r))throw new a.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_IRI_MAPPING)}if("string"!=typeof d)throw new a.ErrorCoded(`Detected non-string @id in context entry: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_IRI_MAPPING);if(l.Util.getPrefix(d,t)===r)throw new a.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.CYCLIC_IRI_MAPPING);break;case"@type":if("@type"===i["@container"]&&"@id"!==d&&"@vocab"!==d)throw new a.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${r}': '${d}'`,a.ERROR_CODES.INVALID_TYPE_MAPPING);if("string"!=typeof d)throw new a.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(n)}'`,a.ERROR_CODES.INVALID_TYPE_MAPPING);if(!("@id"===d||"@vocab"===d||1!==e&&"@json"===d||1!==e&&"@none"===d||"_"!==d[0]&&l.Util.isValidIri(d)))throw new a.ErrorCoded(`A context @type must be an absolute IRI, found: '${r}': '${d}'`,a.ERROR_CODES.INVALID_TYPE_MAPPING);break;case"@reverse":if("string"==typeof d&&i["@id"]&&i["@id"]!==d)throw new a.ErrorCoded(`Found non-matching @id and @reverse term values in '${r}':'${d}' and '${i["@id"]}'`,a.ERROR_CODES.INVALID_REVERSE_PROPERTY);if("@nest"in i)throw new a.ErrorCoded(`@nest is not allowed in the reverse property '${r}'`,a.ERROR_CODES.INVALID_REVERSE_PROPERTY);break;case"@container":if(1===e&&(Object.keys(d).length>1||l.Util.CONTAINERS_1_0.indexOf(Object.keys(d)[0])<0))throw new a.ErrorCoded(`Invalid term @container for '${r}' ('${Object.keys(d)}') in 1.0, must be only one of ${l.Util.CONTAINERS_1_0.join(", ")}`,a.ERROR_CODES.INVALID_CONTAINER_MAPPING);for(const t of Object.keys(d)){if("@list"===t&&i["@reverse"])throw new a.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${r}'`,a.ERROR_CODES.INVALID_REVERSE_PROPERTY);if(l.Util.CONTAINERS.indexOf(t)<0)throw new a.ErrorCoded(`Invalid term @container for '${r}' ('${t}'), must be one of ${l.Util.CONTAINERS.join(", ")}`,a.ERROR_CODES.INVALID_CONTAINER_MAPPING)}break;case"@language":c.validateLanguage(d,!0,a.ERROR_CODES.INVALID_LANGUAGE_MAPPING);break;case"@direction":c.validateDirection(d,!0);break;case"@prefix":if(null!==d&&"boolean"!=typeof d)throw new a.ErrorCoded(`Found an invalid term @prefix boolean in: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_PREFIX_VALUE);if(!("@id"in i)&&!l.Util.isValidIri(r))throw new a.ErrorCoded(`Invalid @prefix definition for '${r}' ('${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@index":if(1===e||!i["@container"]||!i["@container"]["@index"])throw new a.ErrorCoded(`Attempt to add illegal key to value object: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@nest":if(l.Util.isPotentialKeyword(d)&&"@nest"!==d)throw new a.ErrorCoded(`Found an invalid term @nest value in: '${r}': '${JSON.stringify(i)}'`,a.ERROR_CODES.INVALID_NEST_VALUE)}}break;default:throw new a.ErrorCoded(`Found an invalid term value: '${r}': '${i}'`,a.ERROR_CODES.INVALID_TERM_DEFINITION)}}}applyBaseEntry(t,e,r){return"string"==typeof t||(r&&!("@base"in t)&&e.parentContext&&"@base"in e.parentContext&&(t["@base"]=e.parentContext["@base"],e.parentContext["@__baseDocument"]&&(t["@__baseDocument"]=!0)),e.baseIRI&&!e.external&&("@base"in t?null===t["@base"]||"string"!=typeof t["@base"]||l.Util.isValidIri(t["@base"])||(t["@base"]=n.resolve(t["@base"],e.parentContext&&e.parentContext["@base"]||e.baseIRI)):(t["@base"]=e.baseIRI,t["@__baseDocument"]=!0))),t}normalizeContextIri(t,e){if(!l.Util.isValidIri(t)&&(t=n.resolve(t,e),!l.Util.isValidIri(t)))throw new Error(`Invalid context IRI: ${t}`);return this.redirectSchemaOrgHttps&&t.startsWith("http://schema.org")&&(t="https://schema.org/"),t}parseInnerContexts(t,e){return i(this,void 0,void 0,(function*(){for(const r of Object.keys(t)){const i=t[r];if(i&&"object"==typeof i&&"@context"in i&&null!==i["@context"]){if(this.validateContext)try{const n=Object.assign({},t);n[r]=Object.assign({},n[r]),delete n[r]["@context"],yield this.parse(i["@context"],Object.assign(Object.assign({},e),{parentContext:n,ignoreProtection:!0,ignoreRemoteScopedContexts:!0}))}catch(t){throw new a.ErrorCoded(t.message,a.ERROR_CODES.INVALID_SCOPED_CONTEXT)}i["@context"]=(yield this.parse(i["@context"],Object.assign(Object.assign({},e),{minimalProcessing:!0,ignoreRemoteScopedContexts:!0,parentContext:t}))).getContextRaw()}}return t}))}parse(t,r={processingMode:c.DEFAULT_PROCESSING_MODE}){return i(this,void 0,void 0,(function*(){const{baseIRI:i,parentContext:n,external:s,processingMode:d,normalizeLanguageTags:u,ignoreProtection:h,minimalProcessing:f}=r;let p=n;const g=r.remoteContexts||{};if(Object.keys(g).length>=this.remoteContextsDepthLimit)throw new a.ErrorCoded("Detected an overflow in remote context inclusions: "+Object.keys(g),a.ERROR_CODES.CONTEXT_OVERFLOW);if(null==t){if(!h&&p&&l.Util.hasProtectedTerms(p))throw new a.ErrorCoded("Illegal context nullification when terms are protected",a.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);return new o.JsonLdContextNormalized(this.applyBaseEntry({},r,!1))}if("string"==typeof t){const e=this.normalizeContextIri(t,i),n=this.getOverriddenLoad(e,r);if(n)return new o.JsonLdContextNormalized(n);const a=yield this.parse(yield this.load(e),Object.assign(Object.assign({},r),{baseIRI:e,external:!0,remoteContexts:Object.assign(Object.assign({},g),{[e]:!0})}));return this.applyBaseEntry(a.getContextRaw(),r,!0),a}if(Array.isArray(t)){const e=[],n=yield Promise.all(t.map(((t,n)=>{if("string"==typeof t){const a=this.normalizeContextIri(t,i);e[n]=a;return this.getOverriddenLoad(a,r)||this.load(a)}return t})));if(f)return new o.JsonLdContextNormalized(n);const a=yield n.reduce(((t,i,n)=>t.then((t=>this.parse(i,Object.assign(Object.assign({},r),{baseIRI:e[n]||r.baseIRI,external:!!e[n]||r.external,parentContext:t.getContextRaw(),remoteContexts:e[n]?Object.assign(Object.assign({},g),{[e[n]]:!0}):g}))))),Promise.resolve(new o.JsonLdContextNormalized(p||{})));return this.applyBaseEntry(a.getContextRaw(),r,!0),a}if("object"==typeof t){if("@context"in t)return yield this.parse(t["@context"],r);t=JSON.parse(JSON.stringify(t)),p&&(p=JSON.parse(JSON.stringify(p)));let n={};if(s&&delete t["@base"],this.applyBaseEntry(t,r,!0),this.containersToHash(t),f)return new o.JsonLdContextNormalized(t);let l={};if("@import"in t){if(!(d&&d>=1.1))throw new a.ErrorCoded("Context importing is not supported in JSON-LD 1.0",a.ERROR_CODES.INVALID_CONTEXT_ENTRY);if("string"!=typeof t["@import"])throw new a.ErrorCoded("An @import value must be a string, but got "+typeof t["@import"],a.ERROR_CODES.INVALID_IMPORT_VALUE);l=yield this.loadImportContext(this.normalizeContextIri(t["@import"],i)),delete t["@import"]}n=Object.assign(Object.assign(Object.assign(Object.assign({},n),p),l),t);const g=new o.JsonLdContextNormalized(n);return yield this.parseInnerContexts(n,r),!h&&p&&d&&d>=1.1&&this.validateKeywordRedefinitions(p,n,e.defaultExpandOptions),(n&&n["@version"]||d||c.DEFAULT_PROCESSING_MODE)>=1.1&&(t["@vocab"]&&"string"==typeof t["@vocab"]||""===t["@vocab"])&&t["@vocab"].indexOf(":")<0&&p&&"@vocab"in p&&(n["@vocab"]=p["@vocab"]+t["@vocab"]),this.idifyReverseTerms(n),this.expandPrefixedTerms(g,this.expandContentTypeToBase),this.normalize(n,{processingMode:d,normalizeLanguageTags:u}),this.applyScopedProtected(n,{processingMode:d}),this.validateContext&&this.validate(n,{processingMode:d}),g}throw new a.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${t}`,a.ERROR_CODES.INVALID_LOCAL_CONTEXT)}))}load(t){return i(this,void 0,void 0,(function*(){const e=this.documentCache[t];if(e)return"string"==typeof e?e:Array.isArray(e)?e.slice():Object.assign({},e);let r;try{r=yield this.documentLoader.load(t)}catch(e){throw new a.ErrorCoded(`Failed to load remote context ${t}: ${e.message}`,a.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED)}if(!("@context"in r))throw new a.ErrorCoded(`Missing @context in remote context at ${t}`,a.ERROR_CODES.INVALID_REMOTE_CONTEXT);return this.documentCache[t]=r["@context"]}))}getOverriddenLoad(t,e){if(t in(e.remoteContexts||{})){if(e.ignoreRemoteScopedContexts)return t;throw new a.ErrorCoded("Detected a cyclic context inclusion of "+t,a.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION)}return null}loadImportContext(t){return i(this,void 0,void 0,(function*(){const e=yield this.load(t);if("object"!=typeof e||Array.isArray(e))throw new a.ErrorCoded("An imported context must be a single object: "+t,a.ERROR_CODES.INVALID_REMOTE_CONTEXT);if("@import"in e)throw new a.ErrorCoded("An imported context can not import another context: "+t,a.ERROR_CODES.INVALID_CONTEXT_ENTRY);return e}))}}e.ContextParser=c,c.DEFAULT_PROCESSING_MODE=1.1,e.defaultExpandOptions={allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}},11:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ERROR_CODES=e.ErrorCoded=void 0;class r extends Error{constructor(t,e){super(t),this.code=e}}var i;e.ErrorCoded=r,(i=e.ERROR_CODES||(e.ERROR_CODES={})).COLLIDING_KEYWORDS="colliding keywords",i.CONFLICTING_INDEXES="conflicting indexes",i.CYCLIC_IRI_MAPPING="cyclic IRI mapping",i.INVALID_ID_VALUE="invalid @id value",i.INVALID_INDEX_VALUE="invalid @index value",i.INVALID_NEST_VALUE="invalid @nest value",i.INVALID_PREFIX_VALUE="invalid @prefix value",i.INVALID_PROPAGATE_VALUE="invalid @propagate value",i.INVALID_REVERSE_VALUE="invalid @reverse value",i.INVALID_IMPORT_VALUE="invalid @import value",i.INVALID_VERSION_VALUE="invalid @version value",i.INVALID_BASE_IRI="invalid base IRI",i.INVALID_CONTAINER_MAPPING="invalid container mapping",i.INVALID_CONTEXT_ENTRY="invalid context entry",i.INVALID_CONTEXT_NULLIFICATION="invalid context nullification",i.INVALID_DEFAULT_LANGUAGE="invalid default language",i.INVALID_INCLUDED_VALUE="invalid @included value",i.INVALID_IRI_MAPPING="invalid IRI mapping",i.INVALID_JSON_LITERAL="invalid JSON literal",i.INVALID_KEYWORD_ALIAS="invalid keyword alias",i.INVALID_LANGUAGE_MAP_VALUE="invalid language map value",i.INVALID_LANGUAGE_MAPPING="invalid language mapping",i.INVALID_LANGUAGE_TAGGED_STRING="invalid language-tagged string",i.INVALID_LANGUAGE_TAGGED_VALUE="invalid language-tagged value",i.INVALID_LOCAL_CONTEXT="invalid local context",i.INVALID_REMOTE_CONTEXT="invalid remote context",i.INVALID_REVERSE_PROPERTY="invalid reverse property",i.INVALID_REVERSE_PROPERTY_MAP="invalid reverse property map",i.INVALID_REVERSE_PROPERTY_VALUE="invalid reverse property value",i.INVALID_SCOPED_CONTEXT="invalid scoped context",i.INVALID_SCRIPT_ELEMENT="invalid script element",i.INVALID_SET_OR_LIST_OBJECT="invalid set or list object",i.INVALID_TERM_DEFINITION="invalid term definition",i.INVALID_TYPE_MAPPING="invalid type mapping",i.INVALID_TYPE_VALUE="invalid type value",i.INVALID_TYPED_VALUE="invalid typed value",i.INVALID_VALUE_OBJECT="invalid value object",i.INVALID_VALUE_OBJECT_VALUE="invalid value object value",i.INVALID_VOCAB_MAPPING="invalid vocab mapping",i.IRI_CONFUSED_WITH_PREFIX="IRI confused with prefix",i.KEYWORD_REDEFINITION="keyword redefinition",i.LOADING_DOCUMENT_FAILED="loading document failed",i.LOADING_REMOTE_CONTEXT_FAILED="loading remote context failed",i.MULTIPLE_CONTEXT_LINK_HEADERS="multiple context link headers",i.PROCESSING_MODE_CONFLICT="processing mode conflict",i.PROTECTED_TERM_REDEFINITION="protected term redefinition",i.CONTEXT_OVERFLOW="context overflow",i.INVALID_BASE_DIRECTION="invalid base direction",i.RECURSIVE_CONTEXT_INCLUSION="recursive context inclusion",i.INVALID_STREAMING_KEY_ORDER="invalid streaming key order"},378:function(t,e,r){"use strict";var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))((function(n,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,o)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.FetchDocumentLoader=void 0,r(905);const n=r(11),a=r(475),s=r(912);e.FetchDocumentLoader=class{constructor(t){this.fetcher=t}load(t){return i(this,void 0,void 0,(function*(){const e=yield(this.fetcher||fetch)(t,{headers:new Headers({accept:"application/ld+json"})});if(e.ok&&e.headers){let r=e.headers.get("Content-Type");if(r){const t=r.indexOf(";");t>0&&(r=r.substr(0,t))}if("application/ld+json"===r)return yield e.json();if(e.headers.has("Link")){let r;if(e.headers.forEach(((e,i)=>{if("link"===i){const i=a.parse(e);for(const e of i.get("type","application/ld+json"))if("alternate"===e.rel){if(r)throw new Error("Multiple JSON-LD alternate links were found on "+t);r=s.resolve(e.uri,t)}}})),r)return this.load(r)}throw new n.ErrorCoded(`Unsupported JSON-LD media type ${r}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}throw new Error(e.statusText||`Status code: ${e.status}`)}))}}},891:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},0:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},656:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdContextNormalized=void 0;const i=r(912),n=r(931),a=r(11),s=r(990);e.JsonLdContextNormalized=class{constructor(t){this.contextRaw=t}getContextRaw(){return this.contextRaw}expandTerm(t,e,r=n.defaultExpandOptions){const o=this.contextRaw[t];if(null===o||o&&null===o["@id"])return null;let l=!0;if(o&&e){const e=s.Util.getContextValueId(o);if(e&&e!==t){if("string"==typeof e&&(s.Util.isValidIri(e)||s.Util.isValidKeyword(e)))return e;s.Util.isPotentialKeyword(e)||(l=!1)}}const d=s.Util.getPrefix(t,this.contextRaw),c=this.contextRaw["@vocab"],u=(!!c||""===c)&&c.indexOf(":")<0,h=this.contextRaw["@base"],f=s.Util.isPotentialKeyword(t);if(d){const e=this.contextRaw[d],i=s.Util.getContextValueId(e);if(i){if("string"!=typeof e&&r.allowPrefixForcing){if("_"!==i[0]&&!f&&!e["@prefix"]&&!(t in this.contextRaw))return t}else if(!s.Util.isSimpleTermDefinitionPrefix(i,r))return t;return i+t.substr(d.length+1)}}else{if(e&&(c||""===c||r.allowVocabRelativeToBase&&h&&u)&&!f&&!s.Util.isCompactIri(t)){if(u){if(r.allowVocabRelativeToBase)return i.resolve(c,h)+t;throw new a.ErrorCoded(`Relative vocab expansion for term '${t}' with vocab '${c}' is not allowed.`,a.ERROR_CODES.INVALID_VOCAB_MAPPING)}return c+t}if(!e&&h&&!f&&!s.Util.isCompactIri(t))return i.resolve(t,h)}if(l)return t;throw new a.ErrorCoded(`Invalid IRI mapping found for context entry '${t}': '${JSON.stringify(o)}'`,a.ERROR_CODES.INVALID_IRI_MAPPING)}compactIri(t,e){if(e&&this.contextRaw["@vocab"]&&t.startsWith(this.contextRaw["@vocab"]))return t.substr(this.contextRaw["@vocab"].length);if(!e&&this.contextRaw["@base"]&&t.startsWith(this.contextRaw["@base"]))return t.substr(this.contextRaw["@base"].length);const r={prefix:"",suffix:t};for(const i in this.contextRaw){const n=this.contextRaw[i];if(n&&!s.Util.isPotentialKeyword(i)){const a=s.Util.getContextValueId(n);if(t.startsWith(a)){const n=t.substr(a.length);if(n)n.length<r.suffix.length&&(r.prefix=i,r.suffix=n);else if(e)return i}}}return r.prefix?r.prefix+":"+r.suffix:t}}},990:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;class r{static isCompactIri(t){return t.indexOf(":")>0&&!(t&&"#"===t[0])}static getPrefix(t,e){if(t&&"#"===t[0])return null;const r=t.indexOf(":");if(r>=0){if(t.length>r+1&&"/"===t.charAt(r+1)&&"/"===t.charAt(r+2))return null;const i=t.substr(0,r);if("_"===i)return null;if(e[i])return i}return null}static getContextValueId(t){if(null===t||"string"==typeof t)return t;return t["@id"]||null}static isSimpleTermDefinitionPrefix(t,e){return!r.isPotentialKeyword(t)&&("_"===t[0]||e.allowPrefixNonGenDelims||r.isPrefixIriEndingWithGenDelim(t))}static isPotentialKeyword(t){return"string"==typeof t&&r.KEYWORD_REGEX.test(t)}static isPrefixIriEndingWithGenDelim(t){return r.ENDS_WITH_GEN_DELIM.test(t)}static isPrefixValue(t){return t&&("string"==typeof t||t&&"object"==typeof t)}static isValidIri(t){return r.IRI_REGEX.test(t)}static isValidIriWeak(t){return!!t&&":"!==t[0]&&r.IRI_REGEX_WEAK.test(t)}static isValidKeyword(t){return r.VALID_KEYWORDS[t]}static isTermProtected(t,e){const r=t[e];return!("string"==typeof r)&&r&&r["@protected"]}static hasProtectedTerms(t){for(const e of Object.keys(t))if(r.isTermProtected(t,e))return!0;return!1}static isReservedInternalKeyword(t){return t.startsWith("@__")}}e.Util=r,r.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`#]*(#[^#]*)?$/,r.IRI_REGEX_WEAK=/(?::[^:])|\//,r.KEYWORD_REGEX=/^@[a-z]+$/i,r.ENDS_WITH_GEN_DELIM=/[:/?#\[\]@]$/,r.REGEX_LANGUAGE_TAG=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,r.REGEX_DIRECTION_TAG=/^(ltr)|(rtl)$/,r.VALID_KEYWORDS={"@base":!0,"@container":!0,"@context":!0,"@direction":!0,"@graph":!0,"@id":!0,"@import":!0,"@included":!0,"@index":!0,"@json":!0,"@language":!0,"@list":!0,"@nest":!0,"@none":!0,"@prefix":!0,"@propagate":!0,"@protected":!0,"@reverse":!0,"@set":!0,"@type":!0,"@value":!0,"@version":!0,"@vocab":!0},r.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language","@version","@direction"],r.ALIAS_DOMAIN_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value","@version"],r.ALIAS_RANGE_BLACKLIST=["@context","@preserve"],r.CONTAINERS=["@list","@set","@index","@language","@graph","@id","@type"],r.CONTAINERS_1_0=["@list","@set","@index"]},758:function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||i(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(r(170),e)},386:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextTree=void 0;class r{constructor(){this.subTrees={}}getContext(t){if(t.length>0){const[e,...r]=t,i=this.subTrees[e];if(i){const t=i.getContext(r);if(t)return t.then((({context:t,depth:e})=>({context:t,depth:e+1})))}}return this.context?this.context.then((t=>({context:t,depth:0}))):null}setContext(t,e){if(0===t.length)this.context=e;else{const[i,...n]=t;let a=this.subTrees[i];a||(a=this.subTrees[i]=new r),a.setContext(n,e)}}removeContext(t){this.setContext(t,null)}}e.ContextTree=r},170:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JsonLdParser=void 0;const i=r(222),n=r(288),a=r(86),s=r(889),o=r(753),l=r(215),d=r(488),c=r(613),u=r(330),h=r(709),f=r(406),p=r(323),g=r(820),y=r(963),E=r(322),C=r(478),w=r(754),_=r(475);class I extends a.Transform{constructor(t){super({readableObjectMode:!0}),t=t||{},this.options=t,this.parsingContext=new C.ParsingContext(Object.assign({parser:this},t)),this.util=new w.Util({dataFactory:t.dataFactory,parsingContext:this.parsingContext}),this.jsonParser=new i,this.contextJobs=[],this.typeJobs=[],this.contextAwaitingJobs=[],this.lastDepth=0,this.lastKeys=[],this.lastOnValueJob=Promise.resolve(),this.attachJsonParserListeners()}static fromHttpResponse(t,e,r,i){let a,s;if("application/ld+json"!==e){if("application/json"!==e&&!e.endsWith("+json"))throw new n.ErrorCoded(`Unsupported JSON-LD media type ${e}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED);if(r&&r.has("Link")&&r.forEach(((e,r)=>{if("link"===r){const r=_.parse(e);for(const e of r.get("rel","http://www.w3.org/ns/json-ld#context")){if(a)throw new n.ErrorCoded("Multiple JSON-LD context link headers were found on "+t,n.ERROR_CODES.MULTIPLE_CONTEXT_LINK_HEADERS);a=e.uri}}})),!a&&!(null==i?void 0:i.ignoreMissingContextLinkHeader))throw new n.ErrorCoded(`Missing context link header for media type ${e} on ${t}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}if(r&&r.has("Content-Type")){const t=r.get("Content-Type"),e=/; *profile=([^"]*)/.exec(t);e&&"http://www.w3.org/ns/json-ld#streaming"===e[1]&&(s=!0)}return new I(Object.assign({baseIRI:t,context:a,streamingProfile:s},i||{}))}import(t){const e=new a.PassThrough({readableObjectMode:!0});t.on("error",(t=>r.emit("error",t))),t.on("data",(t=>e.push(t))),t.on("end",(()=>e.push(null)));const r=e.pipe(new I(this.options));return r}_transform(t,e,r){this.jsonParser.write(t),this.lastOnValueJob.then((()=>r()),(t=>r(t)))}async newOnValueJob(t,e,r,i){let a=!0;if(i&&r<this.lastDepth){const t=this.parsingContext.listPointerStack[this.lastDepth];t&&(t.value&&this.emit("data",this.util.dataFactory.quad(t.value,this.util.rdfRest,this.util.rdfNil,this.util.getDefaultGraph())),t.listId.listHead=!0,this.parsingContext.idStack[t.listRootDepth+1]=[t.listId],this.parsingContext.listPointerStack.splice(this.lastDepth,1)),await o.EntryHandlerContainer.isBufferableContainerHandler(this.parsingContext,this.lastKeys,this.lastDepth)?(this.parsingContext.pendingContainerFlushBuffers.push({depth:this.lastDepth,keys:this.lastKeys.slice(0,this.lastKeys.length)}),a=!1):await this.flushBuffer(this.lastDepth,this.lastKeys)}const s=await this.util.unaliasKeyword(t[r],t,r),l=await this.util.unaliasKeywordParent(t,r);this.parsingContext.emittedStack[r]=!0;let d=!0;n.Util.isValidKeyword(s)&&"@reverse"===l&&this.emit("error",new n.ErrorCoded(`Found the @id '${e}' inside an @reverse property`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY_MAP));let c=!1;this.parsingContext.validationStack.length>1&&(c=this.parsingContext.validationStack[this.parsingContext.validationStack.length-1].property);for(let e=Math.max(1,this.parsingContext.validationStack.length-1);e<t.length-1;e++){const i=this.parsingContext.validationStack[e]||(this.parsingContext.validationStack[e]=await this.validateKey(t.slice(0,e+1),e,c));if(!i.valid){this.parsingContext.emittedStack[r]=!1,d=!1;break}!c&&i.property&&(c=!0)}if(this.util.isLiteral(r)&&(d=!1),d)for(const i of I.ENTRY_HANDLERS){const n=await i.test(this.parsingContext,this.util,s,t,r);if(n){await i.handle(this.parsingContext,this.util,s,t,e,r,n),i.isStackProcessor()&&(this.parsingContext.processingStack[r]=!0);break}}0===r&&Array.isArray(e)&&await this.util.validateValueIndexes(e),a&&r<this.lastDepth&&this.flushStacks(this.lastDepth),this.lastDepth=r,this.lastKeys=t,this.parsingContext.unaliasedKeywordCacheStack.splice(r-1)}flushStacks(t){this.parsingContext.processingStack.splice(t,1),this.parsingContext.processingType.splice(t,1),this.parsingContext.emittedStack.splice(t,1),this.parsingContext.idStack.splice(t,1),this.parsingContext.graphStack.splice(t+1,1),this.parsingContext.graphContainerTermStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1),this.parsingContext.validationStack.splice(t-1,2),this.parsingContext.literalStack.splice(t,this.parsingContext.literalStack.length-t)}async flushBuffer(t,e){let r=this.parsingContext.idStack[t];r||(r=this.parsingContext.idStack[t]=[this.util.dataFactory.blankNode()]);const i=this.parsingContext.unidentifiedValuesBuffer[t];if(i){for(const n of r){const r=await this.util.getDepthOffsetGraph(t,e),a=this.parsingContext.graphStack[t]||r>=0?this.parsingContext.idStack[t-r-1]:[await this.util.getGraphContainerValue(e,t)];if(a)for(const e of a){this.parsingContext.emittedStack[t]=!0;for(const r of i)r.reverse?this.parsingContext.emitQuad(t,this.util.dataFactory.quad(r.object,r.predicate,n,e)):this.parsingContext.emitQuad(t,this.util.dataFactory.quad(n,r.predicate,r.object,e))}else{const r=this.parsingContext.getUnidentifiedGraphBufferSafe(t-await this.util.getDepthOffsetGraph(t,e)-1);for(const t of i)t.reverse?r.push({object:n,predicate:t.predicate,subject:t.object}):r.push({object:t.object,predicate:t.predicate,subject:n})}}this.parsingContext.unidentifiedValuesBuffer.splice(t,1),this.parsingContext.literalStack.splice(t,1),this.parsingContext.jsonLiteralStack.splice(t,1)}const n=this.parsingContext.unidentifiedGraphsBuffer[t];if(n){for(const e of r){const r=1!==t||"BlankNode"!==e.termType||this.parsingContext.topLevelProperties?e:this.util.getDefaultGraph();this.parsingContext.emittedStack[t]=!0;for(const e of n)this.parsingContext.emitQuad(t,this.util.dataFactory.quad(e.subject,e.predicate,e.object,r))}this.parsingContext.unidentifiedGraphsBuffer.splice(t,1)}}async validateKey(t,e,r){for(const i of I.ENTRY_HANDLERS)if(await i.validate(this.parsingContext,this.util,t,e,r))return{valid:!0,property:r||i.isPropertyHandler()};return{valid:!1,property:!1}}attachJsonParserListeners(){this.jsonParser.onValue=t=>{const e=this.jsonParser.stack.length,r=new Array(e+1).fill(0).map(((t,r)=>r===e?this.jsonParser.key:this.jsonParser.stack[r].key));if(!this.isParsingContextInner(e)){const i=()=>this.newOnValueJob(r,t,e,!0);if(this.parsingContext.streamingProfile||this.parsingContext.contextTree.getContext(r.slice(0,-1)))this.lastOnValueJob=this.lastOnValueJob.then(i);else if("@context"===r[e]){let t=this.contextJobs[e];t||(t=this.contextJobs[e]=[]),t.push(i)}else"@type"===r[e]||"number"==typeof r[e]&&"@type"===r[e-1]?this.typeJobs.push({job:i,keys:r.slice(0,r.length-1)}):this.contextAwaitingJobs.push({job:i,keys:r});this.parsingContext.streamingProfile||0!==e||(this.lastOnValueJob=this.lastOnValueJob.then((()=>this.executeBufferedJobs())))}},this.jsonParser.onError=t=>{this.emit("error",t)}}isParsingContextInner(t){for(let e=t;e>0;e--)if("@context"===this.jsonParser.stack[e-1].key)return!0;return!1}async executeBufferedJobs(){for(const t of this.contextJobs)if(t)for(const e of t)await e();this.parsingContext.unaliasedKeywordCacheStack.splice(0);for(const t of this.contextAwaitingJobs){if(this.typeJobs.length>0){const e=[],r=[];for(let i=0;i<this.typeJobs.length;i++){const n=this.typeJobs[i];w.Util.isPrefixArray(n.keys,t.keys)&&(e.push(n),r.push(i))}const i=e.sort(((t,e)=>t.keys.length-e.keys.length));for(const t of i)await t.job();const n=r.sort().reverse();for(const t of n)this.typeJobs.splice(t,1)}await t.job()}}}e.JsonLdParser=I,I.DEFAULT_PROCESSING_MODE="1.1",I.ENTRY_HANDLERS=[new s.EntryHandlerArrayValue,new c.EntryHandlerKeywordContext,new h.EntryHandlerKeywordId,new f.EntryHandlerKeywordIncluded,new u.EntryHandlerKeywordGraph,new p.EntryHandlerKeywordNest,new g.EntryHandlerKeywordType,new E.EntryHandlerKeywordValue,new o.EntryHandlerContainer,new y.EntryHandlerKeywordUnknownFallback,new d.EntryHandlerPredicate,new l.EntryHandlerInvalidFallback]},478:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ParsingContext=void 0;const i=r(288),n=r(11),a=r(386),s=r(170);class o{constructor(t){this.contextParser=new i.ContextParser({documentLoader:t.documentLoader}),this.streamingProfile=!!t.streamingProfile,this.baseIRI=t.baseIRI,this.produceGeneralizedRdf=!!t.produceGeneralizedRdf,this.allowSubjectList=!!t.allowSubjectList,this.processingMode=t.processingMode||s.JsonLdParser.DEFAULT_PROCESSING_MODE,this.strictValues=!!t.strictValues,this.validateValueIndexes=!!t.validateValueIndexes,this.defaultGraph=t.defaultGraph,this.rdfDirection=t.rdfDirection,this.normalizeLanguageTags=t.normalizeLanguageTags,this.streamingProfileAllowOutOfOrderPlainType=t.streamingProfileAllowOutOfOrderPlainType,this.topLevelProperties=!1,this.activeProcessingMode=parseFloat(this.processingMode),this.processingStack=[],this.processingType=[],this.emittedStack=[],this.idStack=[],this.graphStack=[],this.graphContainerTermStack=[],this.listPointerStack=[],this.contextTree=new a.ContextTree,this.literalStack=[],this.validationStack=[],this.unaliasedKeywordCacheStack=[],this.jsonLiteralStack=[],this.unidentifiedValuesBuffer=[],this.unidentifiedGraphsBuffer=[],this.pendingContainerFlushBuffers=[],this.parser=t.parser,t.context?(this.rootContext=this.parseContext(t.context),this.rootContext.then((t=>this.validateContext(t)))):this.rootContext=Promise.resolve(new i.JsonLdContextNormalized(this.baseIRI?{"@base":this.baseIRI,"@__baseDocument":!0}:{}))}async parseContext(t,e,r){return this.contextParser.parse(t,{baseIRI:this.baseIRI,ignoreProtection:r,normalizeLanguageTags:this.normalizeLanguageTags,parentContext:e,processingMode:this.activeProcessingMode})}validateContext(t){const e=t.getContextRaw()["@version"];if(e){if(this.activeProcessingMode&&e>this.activeProcessingMode)throw new n.ErrorCoded(`Unsupported JSON-LD version '${e}' under active processing mode ${this.activeProcessingMode}.`,n.ERROR_CODES.PROCESSING_MODE_CONFLICT);if(this.activeProcessingMode&&e<this.activeProcessingMode)throw new n.ErrorCoded(`Invalid JSON-LD version ${e} under active processing mode ${this.activeProcessingMode}.`,n.ERROR_CODES.INVALID_VERSION_VALUE);this.activeProcessingMode=e}}async getContext(t,e=1){const r=t;for(;"number"==typeof t[t.length-1];)t=t.slice(0,t.length-1);e&&(t=t.slice(0,-e));const n=await this.getContextPropagationAware(t);let a=n.context.getContextRaw();for(let t=n.depth;t<r.length-e;t++){const n=r[t],s=a[n];if(s&&"object"==typeof s&&"@context"in s){const o=(await this.parseContext(s,a,!0)).getContextRaw(),l=!(n in o)||o[n]["@context"]["@propagate"];!1===l&&t!==r.length-1-e||(a=o,delete a["@propagate"],a[n]=Object.assign({},a[n]),"@id"in s&&(a[n]["@id"]=s["@id"]),delete a[n]["@context"],!1!==l&&this.contextTree.setContext(r.slice(0,t+e),Promise.resolve(new i.JsonLdContextNormalized(a))))}}return new i.JsonLdContextNormalized(a)}async getContextPropagationAware(t){const e=t.length;let r,n=null;do{r=!1,n&&"@__propagateFallback"in n.context.getContextRaw()?n.context=new i.JsonLdContextNormalized(n.context.getContextRaw()["@__propagateFallback"]):(n&&(t=t.slice(0,n.depth-1)),n=await this.contextTree.getContext(t)||{context:await this.rootContext,depth:0});const e=t[t.length-1];if(e in n.context.getContextRaw()){const t=n.context.getContextRaw()[e];t&&"object"==typeof t&&"@context"in t&&(r=!0)}}while(n.depth>0&&!1===n.context.getContextRaw()["@propagate"]&&n.depth!==e&&!r);return 0===n.depth&&!1===n.context.getContextRaw()["@propagate"]&&n.depth!==e&&(n.context=new i.JsonLdContextNormalized({})),n}async newOnValueJob(t,e,r,i){await this.parser.newOnValueJob(t,e,r,i)}async handlePendingContainerFlushBuffers(){if(this.pendingContainerFlushBuffers.length>0){for(const t of this.pendingContainerFlushBuffers)await this.parser.flushBuffer(t.depth,t.keys),this.parser.flushStacks(t.depth);return this.pendingContainerFlushBuffers.splice(0,this.pendingContainerFlushBuffers.length),!0}return!1}emitQuad(t,e){1===t&&(this.topLevelProperties=!0),this.parser.push(e)}emitError(t){this.parser.emit("error",t)}emitContext(t){this.parser.emit("context",t)}getUnidentifiedValueBufferSafe(t){let e=this.unidentifiedValuesBuffer[t];return e||(e=[],this.unidentifiedValuesBuffer[t]=e),e}getUnidentifiedGraphBufferSafe(t){let e=this.unidentifiedGraphsBuffer[t];return e||(e=[],this.unidentifiedGraphsBuffer[t]=e),e}getExpandOptions(){return o.EXPAND_OPTIONS[this.activeProcessingMode]}shiftStack(t,e){const r=this.idStack[t+e];if(r&&(this.idStack[t]=r,this.emittedStack[t]=!0,delete this.idStack[t+e]),this.pendingContainerFlushBuffers.length)for(const r of this.pendingContainerFlushBuffers)r.depth>=t+e&&(r.depth-=e,r.keys.splice(t,e));this.unidentifiedValuesBuffer[t+e]&&(this.unidentifiedValuesBuffer[t]=this.unidentifiedValuesBuffer[t+e],delete this.unidentifiedValuesBuffer[t+e])}}e.ParsingContext=o,o.EXPAND_OPTIONS={1:{allowPrefixForcing:!1,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!1},1.1:{allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}},754:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;const i=r(288),n=r(640),a=r(753),s=r(456);class o{constructor(t){this.parsingContext=t.parsingContext,this.dataFactory=t.dataFactory||new n.DataFactory,this.rdfFirst=this.dataFactory.namedNode(o.RDF+"first"),this.rdfRest=this.dataFactory.namedNode(o.RDF+"rest"),this.rdfNil=this.dataFactory.namedNode(o.RDF+"nil"),this.rdfType=this.dataFactory.namedNode(o.RDF+"type"),this.rdfJson=this.dataFactory.namedNode(o.RDF+"JSON")}static getContextValue(t,e,r,i){const n=t.getContextRaw()[r];if(!n)return i;const a=n[e];return void 0===a?i:a}static getContextValueContainer(t,e){return o.getContextValue(t,"@container",e,{"@set":!0})}static getContextValueType(t,e){const r=o.getContextValue(t,"@type",e,null);return"@none"===r?null:r}static getContextValueLanguage(t,e){return o.getContextValue(t,"@language",e,t.getContextRaw()["@language"]||null)}static getContextValueDirection(t,e){return o.getContextValue(t,"@direction",e,t.getContextRaw()["@direction"]||null)}static isContextValueReverse(t,e){return!!o.getContextValue(t,"@reverse",e,null)}static getContextValueIndex(t,e){return o.getContextValue(t,"@index",e,t.getContextRaw()["@index"]||null)}static isPropertyReverse(t,e,r){return"@reverse"===r!==o.isContextValueReverse(t,e)}static isValidIri(t){return null!==t&&i.Util.isValidIri(t)}static isPrefixArray(t,e){if(t.length>e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}async validateValueIndexes(t){if(this.parsingContext.validateValueIndexes){const e={};for(const r of t)if(r&&"object"==typeof r){const t=r["@id"],n=r["@index"];if(t&&n){const r=e[t];if(r&&r!==n)throw new i.ErrorCoded(`Conflicting @index value for ${t}`,i.ERROR_CODES.CONFLICTING_INDEXES);e[t]=n}}}}async valueToTerm(t,e,r,n,a){if("@json"===o.getContextValueType(t,e))return[this.dataFactory.literal(this.valueToJsonString(r),this.rdfJson)];const s=typeof r;switch(s){case"object":if(null==r)return[];if(Array.isArray(r))return"@list"in o.getContextValueContainer(t,e)?0===r.length?[this.rdfNil]:this.parsingContext.idStack[n+1]||[]:(await this.validateValueIndexes(r),[]);if(t=await this.getContextSelfOrPropertyScoped(t,e),"@context"in r&&(t=await this.parsingContext.parseContext(r["@context"],(await this.parsingContext.getContext(a,0)).getContextRaw())),"@value"in(r=await this.unaliasKeywords(r,a,n,t))){let s,o,l,d,c;for(e in r){const t=r[e];switch(e){case"@value":s=t;break;case"@language":o=t;break;case"@direction":l=t;break;case"@type":d=t;break;case"@index":c=t;break;default:throw new i.ErrorCoded(`Unknown value entry '${e}' in @value: ${JSON.stringify(r)}`,i.ERROR_CODES.INVALID_VALUE_OBJECT)}}if("@json"===await this.unaliasKeyword(d,a,n,!0,t))return[this.dataFactory.literal(this.valueToJsonString(s),this.rdfJson)];if(null===s)return[];if("object"==typeof s)throw new i.ErrorCoded(`The value of an '@value' can not be an object, got '${JSON.stringify(s)}'`,i.ERROR_CODES.INVALID_VALUE_OBJECT_VALUE);if(this.parsingContext.validateValueIndexes&&c&&"string"!=typeof c)throw new i.ErrorCoded(`The value of an '@index' must be a string, got '${JSON.stringify(c)}'`,i.ERROR_CODES.INVALID_INDEX_VALUE);if(o){if("string"!=typeof s)throw new i.ErrorCoded(`When an '@language' is set, the value of '@value' must be a string, got '${JSON.stringify(s)}'`,i.ERROR_CODES.INVALID_LANGUAGE_TAGGED_VALUE);if(!i.ContextParser.validateLanguage(o,this.parsingContext.strictValues,i.ERROR_CODES.INVALID_LANGUAGE_TAGGED_STRING))return[];(this.parsingContext.normalizeLanguageTags||1===this.parsingContext.activeProcessingMode)&&(o=o.toLowerCase())}if(l){if("string"!=typeof s)throw new Error(`When an '@direction' is set, the value of '@value' must be a string, got '${JSON.stringify(s)}'`);if(!i.ContextParser.validateDirection(l,this.parsingContext.strictValues))return[]}if(o&&l&&this.parsingContext.rdfDirection){if(d)throw new i.ErrorCoded(`Can not have '@language', '@direction' and '@type' in a value: '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(n,s,o,l))}if(o){if(d)throw new i.ErrorCoded(`Can not have both '@language' and '@type' in a value: '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_VALUE_OBJECT);return[this.dataFactory.literal(s,o)]}if(l&&this.parsingContext.rdfDirection){if(d)throw new i.ErrorCoded(`Can not have both '@direction' and '@type' in a value: '${JSON.stringify(r)}'`,i.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(n,s,o,l))}if(d){if("string"!=typeof d)throw new i.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(d)}'`,i.ERROR_CODES.INVALID_TYPED_VALUE);const e=this.createVocabOrBaseTerm(t,d);if(!e)throw new i.ErrorCoded(`Invalid '@type' value, got '${JSON.stringify(d)}'`,i.ERROR_CODES.INVALID_TYPED_VALUE);if("NamedNode"!==e.termType)throw new i.ErrorCoded(`Illegal value type (${e.termType}): ${d}`,i.ERROR_CODES.INVALID_TYPED_VALUE);return[this.dataFactory.literal(s,e)]}return await this.valueToTerm(new i.JsonLdContextNormalized({}),e,s,n,a)}if("@set"in r){if(Object.keys(r).length>1)throw new i.ErrorCoded(`Found illegal neighbouring entries next to @set for key: '${e}'`,i.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);return[]}if("@list"in r){if(Object.keys(r).length>1)throw new i.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${e}'`,i.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);const t=r["@list"];return Array.isArray(t)?0===t.length?[this.rdfNil]:this.parsingContext.idStack[n+1]||[]:await this.valueToTerm(await this.parsingContext.getContext(a),e,t,n-1,a.slice(0,-1))}if("@reverse"in r)return[];if("@graph"in o.getContextValueContainer(await this.parsingContext.getContext(a),e)){const t=this.parsingContext.graphContainerTermStack[n+1];return t?Object.values(t):[this.dataFactory.blankNode()]}return"@id"in r?(Object.keys(r).length>1&&(t=await this.parsingContext.getContext(a,0)),"@context"in r&&(t=await this.parsingContext.parseContext(r["@context"],t.getContextRaw())),"@vocab"===r["@type"]?this.nullableTermToArray(this.createVocabOrBaseTerm(t,r["@id"])):this.nullableTermToArray(this.resourceToTerm(t,r["@id"]))):this.parsingContext.emittedStack[n+1]||r&&"object"==typeof r&&0===Object.keys(r).length?this.parsingContext.idStack[n+1]||(this.parsingContext.idStack[n+1]=[this.dataFactory.blankNode()]):[];case"string":return this.nullableTermToArray(this.stringValueToTerm(n,await this.getContextSelfOrPropertyScoped(t,e),e,r,null));case"boolean":return this.nullableTermToArray(this.stringValueToTerm(n,await this.getContextSelfOrPropertyScoped(t,e),e,Boolean(r).toString(),this.dataFactory.namedNode(o.XSD_BOOLEAN)));case"number":return this.nullableTermToArray(this.stringValueToTerm(n,await this.getContextSelfOrPropertyScoped(t,e),e,r,this.dataFactory.namedNode(r%1==0&&r<1e21?o.XSD_INTEGER:o.XSD_DOUBLE)));default:return this.parsingContext.emitError(new Error(`Could not determine the RDF type of a ${s}`)),[]}}async getContextSelfOrPropertyScoped(t,e){const r=t.getContextRaw()[e];return r&&"object"==typeof r&&"@context"in r&&(t=await this.parsingContext.parseContext(r,t.getContextRaw(),!0)),t}nullableTermToArray(t){return t?[t]:[]}predicateToTerm(t,e){const r=t.expandTerm(e,!0,this.parsingContext.getExpandOptions());return r?"_"===r[0]&&":"===r[1]?this.parsingContext.produceGeneralizedRdf?this.dataFactory.blankNode(r.substr(2)):null:o.isValidIri(r)?this.dataFactory.namedNode(r):r&&this.parsingContext.strictValues?(this.parsingContext.emitError(new i.ErrorCoded(`Invalid predicate IRI: ${r}`,i.ERROR_CODES.INVALID_IRI_MAPPING)),null):null:null}resourceToTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const r=t.expandTerm(e,!1,this.parsingContext.getExpandOptions());if(!o.isValidIri(r)){if(!r||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(new Error(`Invalid resource IRI: ${r}`))}return this.dataFactory.namedNode(r)}createVocabOrBaseTerm(t,e){if(e.startsWith("_:"))return this.dataFactory.blankNode(e.substr(2));const r=this.parsingContext.getExpandOptions();let i=t.expandTerm(e,!0,r);if(i===e&&(i=t.expandTerm(e,!1,r)),!o.isValidIri(i)){if(!i||!this.parsingContext.strictValues)return null;this.parsingContext.emitError(new Error(`Invalid term IRI: ${i}`))}return this.dataFactory.namedNode(i)}intToString(t,e){return"number"==typeof t?Number.isFinite(t)?t%1!=0||e&&e.value===o.XSD_DOUBLE?t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"):Number(t).toString():t>0?"INF":"-INF":t}stringValueToTerm(t,e,r,i,n){const a=o.getContextValueType(e,r);if(a)if("@id"===a){if(!n)return this.resourceToTerm(e,this.intToString(i,n))}else if("@vocab"===a){if(!n)return this.createVocabOrBaseTerm(e,this.intToString(i,n))}else n=this.dataFactory.namedNode(a);if(!n){const a=o.getContextValueLanguage(e,r),s=o.getContextValueDirection(e,r);return s&&this.parsingContext.rdfDirection?this.createLanguageDirectionLiteral(t,this.intToString(i,n),a,s):this.dataFactory.literal(this.intToString(i,n),a)}return this.dataFactory.literal(this.intToString(i,n),n)}createLanguageDirectionLiteral(t,e,r,i){if("i18n-datatype"===this.parsingContext.rdfDirection)return r||(r=""),this.dataFactory.literal(e,this.dataFactory.namedNode(`https://www.w3.org/ns/i18n#${r}_${i}`));{const n=this.dataFactory.blankNode(),a=this.getDefaultGraph();return this.parsingContext.emitQuad(t,this.dataFactory.quad(n,this.dataFactory.namedNode(o.RDF+"value"),this.dataFactory.literal(e),a)),r&&this.parsingContext.emitQuad(t,this.dataFactory.quad(n,this.dataFactory.namedNode(o.RDF+"language"),this.dataFactory.literal(r),a)),this.parsingContext.emitQuad(t,this.dataFactory.quad(n,this.dataFactory.namedNode(o.RDF+"direction"),this.dataFactory.literal(i),a)),n}}valueToJsonString(t){return s(t)}async unaliasKeyword(t,e,r,n,a){if(Number.isInteger(t))return t;if(!n){const t=this.parsingContext.unaliasedKeywordCacheStack[r];if(t)return t}if(!i.Util.isPotentialKeyword(t)){let r=(a=a||await this.parsingContext.getContext(e)).getContextRaw()[t];r&&"object"==typeof r&&(r=r["@id"]),i.Util.isValidKeyword(r)&&(t=r)}return n?t:this.parsingContext.unaliasedKeywordCacheStack[r]=t}async unaliasKeywordParent(t,e){return await this.unaliasKeyword(e>0&&t[e-1],t,e-1)}async unaliasKeywords(t,e,r,i){const n={};for(const a in t)n[await this.unaliasKeyword(a,e,r+1,!0,i)]=t[a];return n}isLiteral(t){for(let e=t;e>=0;e--)if(this.parsingContext.literalStack[e]||this.parsingContext.jsonLiteralStack[e])return!0;return!1}async getDepthOffsetGraph(t,e){for(let r=t-1;r>0;r--)if("@graph"===await this.unaliasKeyword(e[r],e,r)){const i=(await a.EntryHandlerContainer.getContainerHandler(this.parsingContext,e,r)).containers;return a.EntryHandlerContainer.isComplexGraphContainer(i)?-1:t-r-1}return-1}validateReverseSubject(t){if("Literal"===t.termType)throw new i.ErrorCoded(`Found illegal literal in subject position: ${t.value}`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}getDefaultGraph(){return this.parsingContext.defaultGraph||this.dataFactory.defaultGraph()}async getGraphContainerValue(t,e){let r=this.getDefaultGraph();const{containers:i,depth:n}=await a.EntryHandlerContainer.getContainerHandler(this.parsingContext,t,e);if("@graph"in i){const e=a.EntryHandlerContainer.getContainerGraphIndex(i,n,t),s=this.parsingContext.graphContainerTermStack[n];if(r=s?s[e]:null,!r){let a=null;if("@id"in i){const e=await this.getContainerKey(t[n],t,n);null!==e&&(a=await this.resourceToTerm(await this.parsingContext.getContext(t),e))}a||(a=this.dataFactory.blankNode()),this.parsingContext.graphContainerTermStack[n]||(this.parsingContext.graphContainerTermStack[n]={}),r=this.parsingContext.graphContainerTermStack[n][e]=a}}return r}async getPropertiesDepth(t,e){let r=e;for(let i=e-1;i>0;i--)if("number"!=typeof t[i]){const e=await this.unaliasKeyword(t[i],t,i);if("@reverse"===e)return i;if("@nest"!==e)return r;r=i}return r}async getContainerKey(t,e,r){const i=await this.unaliasKeyword(t,e,r);return"@none"===i?null:i}}e.Util=o,o.XSD="http://www.w3.org/2001/XMLSchema#",o.XSD_BOOLEAN=o.XSD+"boolean",o.XSD_INTEGER=o.XSD+"integer",o.XSD_DOUBLE=o.XSD+"double",o.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#"},496:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIdentifier=void 0,e.ContainerHandlerIdentifier=class{canCombineWithGraph(){return!0}async handle(t,e,r,i,n,a){let s;if(e.emittedStack[a+1]&&e.idStack[a+1])s=e.idStack[a+1][0];else{const t=null!==await r.getContainerKey(i[a],i,a)?await r.resourceToTerm(await e.getContext(i),i[a]):r.dataFactory.blankNode();if(!t)return void(e.emittedStack[a]=!1);s=t,e.idStack[a+1]=[s]}let o=e.idStack[a];o||(o=e.idStack[a]=[]),o.some((t=>t.equals(s)))||o.push(s),await e.handlePendingContainerFlushBuffers()||(e.emittedStack[a]=!1)}}},910:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerIndex=void 0;const i=r(288),n=r(488),a=r(754);e.ContainerHandlerIndex=class{canCombineWithGraph(){return!0}async handle(t,e,r,s,o,l){if(!Array.isArray(o)){const d="@graph"in t,c=await e.getContext(s),u=s[l-1],h=a.Util.getContextValueIndex(c,u);if(h){if(i.Util.isPotentialKeyword(h))throw new i.ErrorCoded(`Keywords can not be used as @index value, got: ${h}`,i.ERROR_CODES.INVALID_TERM_DEFINITION);if("string"!=typeof h)throw new i.ErrorCoded(`@index values must be strings, got: ${h}`,i.ERROR_CODES.INVALID_TERM_DEFINITION);if("object"!=typeof o){if("@id"!==a.Util.getContextValueType(c,u))throw new i.ErrorCoded(`Property-based index containers require nodes as values or strings with @type: @id, but got: ${o}`,i.ERROR_CODES.INVALID_VALUE_OBJECT);const t=r.resourceToTerm(c,o);t&&(e.idStack[l+1]=[t])}const t=r.createVocabOrBaseTerm(c,h);if(t){const i=await r.valueToTerm(c,h,await r.getContainerKey(s[l],s,l),l,s);if(d){const n=await r.getGraphContainerValue(s,l+1);for(const a of i)e.emitQuad(l,r.dataFactory.quad(n,t,a,r.getDefaultGraph()))}else for(const a of i)await n.EntryHandlerPredicate.handlePredicateObject(e,r,s,l+1,t,a,!1)}}const f=d?2:1;await e.newOnValueJob(s.slice(0,s.length-f),o,l-f,!0),await e.handlePendingContainerFlushBuffers()}e.emittedStack[l]=!1}}},275:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerLanguage=void 0;const i=r(288);e.ContainerHandlerLanguage=class{canCombineWithGraph(){return!1}async handle(t,e,r,n,a,s){const o=await r.getContainerKey(n[s],n,s);if(Array.isArray(a))a=a.map((t=>({"@value":t,"@language":o})));else{if("string"!=typeof a)throw new i.ErrorCoded(`Got invalid language map value, got '${JSON.stringify(a)}', but expected string`,i.ERROR_CODES.INVALID_LANGUAGE_MAP_VALUE);a={"@value":a,"@language":o}}await e.newOnValueJob(n.slice(0,n.length-1),a,s-1,!0),e.emittedStack[s]=!1}}},358:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerHandlerType=void 0;const i=r(488),n=r(754);e.ContainerHandlerType=class{canCombineWithGraph(){return!1}async handle(t,e,r,a,s,o){if(!Array.isArray(s)){if("string"==typeof s){const t=await e.getContext(a),i="@vocab"===n.Util.getContextValueType(t,a[o-1])?await r.createVocabOrBaseTerm(t,s):await r.resourceToTerm(t,s);if(i){const t={"@id":"NamedNode"===i.termType?i.value:s};await e.newOnValueJob(a.slice(0,a.length-1),t,o-1,!0),e.idStack[o+1]=[i]}}else{const t=!!e.idStack[o+1];t||delete e.idStack[o],await e.newOnValueJob(a.slice(0,a.length-1),s,o-1,!0),t||(e.idStack[o+1]=e.idStack[o])}const t=await r.getContainerKey(a[o],a,o),l=null!==t?r.createVocabOrBaseTerm(await e.getContext(a),t):null;l&&await i.EntryHandlerPredicate.handlePredicateObject(e,r,a,o+1,r.rdfType,l,!1),await e.handlePendingContainerFlushBuffers()}e.emittedStack[o]=!1}}},889:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerArrayValue=void 0;const i=r(754);e.EntryHandlerArrayValue=class{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,i,n){return this.test(t,e,null,r,i)}async test(t,e,r,i,n){return"number"==typeof i[n]}async handle(t,e,r,n,a,s){let o=await e.unaliasKeywordParent(n,s);if("@list"===o){let r=null,i=0;for(let t=s-2;t>0;t--){const e=n[t];if("string"==typeof e||"number"==typeof e){i=t,r=e;break}}if(null!==r){const o=await e.valueToTerm(await t.getContext(n),r,a,s,n);for(const r of o)await this.handleListElement(t,e,r,a,s,n.slice(0,i),i);0===o.length&&await this.handleListElement(t,e,null,a,s,n.slice(0,i),i)}}else if("@set"===o)await t.newOnValueJob(n.slice(0,-2),a,s-2,!1);else if(void 0!==o&&"@type"!==o){for(let t=s-1;t>0;t--)if("number"!=typeof n[t]){o=await e.unaliasKeyword(n[t],n,t);break}const r=await t.getContext(n.slice(0,-1));if("@list"in i.Util.getContextValueContainer(r,o)){t.emittedStack[s+1]=!0;const r=await e.valueToTerm(await t.getContext(n),o,a,s,n);for(const i of r)await this.handleListElement(t,e,i,a,s,n.slice(0,-1),s-1);0===r.length&&await this.handleListElement(t,e,null,a,s,n.slice(0,-1),s-1)}else t.shiftStack(s,1),await t.newOnValueJob(n.slice(0,-1),a,s-1,!1),t.contextTree.removeContext(n.slice(0,-1))}}async handleListElement(t,e,r,i,n,a,s){let o=t.listPointerStack[n];if(null!==i&&null!==(await e.unaliasKeywords(i,a,n))["@value"]){if(o&&o.value){const r=e.dataFactory.blankNode();t.emitQuad(n,e.dataFactory.quad(o.value,e.rdfRest,r,e.getDefaultGraph())),o.value=r}else{const t=e.dataFactory.blankNode();o={value:t,listRootDepth:s,listId:t}}r&&t.emitQuad(n,e.dataFactory.quad(o.value,e.rdfFirst,r,e.getDefaultGraph()))}else o||(o={listRootDepth:s,listId:e.rdfNil});t.listPointerStack[n]=o}}},753:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerContainer=void 0;const i=r(496),n=r(910),a=r(275),s=r(358),o=r(754);class l{static isSimpleGraphContainer(t){return"@graph"in t&&("@set"in t&&2===Object.keys(t).length||1===Object.keys(t).length)}static isComplexGraphContainer(t){return"@graph"in t&&("@set"in t&&Object.keys(t).length>2||!("@set"in t)&&Object.keys(t).length>1)}static getContainerGraphIndex(t,e,r){let i=l.isSimpleGraphContainer(t),n="";for(let t=e;t<r.length;t++)i&&"number"!=typeof r[t]||(n+=":"+r[t]),i||"number"==typeof r[t]||(i=!0);return n}static async getContainerHandler(t,e,r){const i={containers:{"@set":!0},depth:r,fallback:!0};let n=!1;const a=await t.getContext(e,2);for(let t=r-1;t>=0;t--)if("number"!=typeof e[t]){const r=o.Util.getContextValue(a,"@container",e[t],!1);if(r&&l.isSimpleGraphContainer(r))return{containers:r,depth:t+1,fallback:!1};const s=o.Util.getContextValue(a,"@container",e[t-1],!1);if(s){const e="@graph"in s;for(const r in l.CONTAINER_HANDLERS)if(s[r])return e?l.CONTAINER_HANDLERS[r].canCombineWithGraph()?{containers:s,depth:t,fallback:!1}:i:n?i:{containers:s,depth:t,fallback:!1};return i}if(n)return i;n=!0}return i}static async isBufferableContainerHandler(t,e,r){const i=await l.getContainerHandler(t,e,r);return!i.fallback&&!("@graph"in i.containers)}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,i,n){return!!await this.test(t,e,null,r,i)}async test(t,e,r,i,n){const a=o.Util.getContextValueContainer(await t.getContext(i,2),i[n-1]);for(const t in l.CONTAINER_HANDLERS)if(a[t])return{containers:a,handler:l.CONTAINER_HANDLERS[t]};return null}async handle(t,e,r,i,n,a,s){return s.handler.handle(s.containers,t,e,i,n,a)}}e.EntryHandlerContainer=l,l.CONTAINER_HANDLERS={"@id":new i.ContainerHandlerIdentifier,"@index":new n.ContainerHandlerIndex,"@language":new a.ContainerHandlerLanguage,"@type":new s.ContainerHandlerType}},215:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerInvalidFallback=void 0,e.EntryHandlerInvalidFallback=class{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,i,n){return!1}async test(t,e,r,i,n){return!0}async handle(t,e,r,i,n,a){t.emittedStack[a]=!1}}},488:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerPredicate=void 0;const i=r(288),n=r(754);class a{static async handlePredicateObject(t,e,r,i,n,a,s){const o=await e.getPropertiesDepth(r,i),l=await e.getDepthOffsetGraph(i,r),d=i-l,c=t.idStack[o];if(c)for(const u of c)if(l>=0){const r=t.idStack[d-1];if(r)for(const o of r)s?(e.validateReverseSubject(a),t.emitQuad(i,e.dataFactory.quad(a,n,u,o))):t.emitQuad(i,e.dataFactory.quad(u,n,a,o));else s?(e.validateReverseSubject(a),t.getUnidentifiedGraphBufferSafe(d-1).push({subject:a,predicate:n,object:u})):t.getUnidentifiedGraphBufferSafe(d-1).push({subject:u,predicate:n,object:a})}else{const l=await e.getGraphContainerValue(r,o);s?(e.validateReverseSubject(a),t.emitQuad(i,e.dataFactory.quad(a,n,u,l))):t.emitQuad(i,e.dataFactory.quad(u,n,a,l))}else s&&e.validateReverseSubject(a),t.getUnidentifiedValueBufferSafe(o).push({predicate:n,object:a,reverse:s})}isPropertyHandler(){return!0}isStackProcessor(){return!0}async validate(t,e,r,i,a){const s=r[i];if(s){const a=await t.getContext(r);if(await e.predicateToTerm(a,r[i]))return"@json"===n.Util.getContextValueType(a,s)&&(t.jsonLiteralStack[i+1]=!0),!0}return!1}async test(t,e,r,i,n){return i[n]}async handle(t,e,r,s,o,l,d){const c=s[l],u=await t.getContext(s),h=await e.predicateToTerm(u,r);if(h){const d=await e.valueToTerm(u,r,o,l,s);if(d.length)for(let f of d){const d=n.Util.isPropertyReverse(u,c,await e.unaliasKeywordParent(s,l));if(o){const a="@list"in n.Util.getContextValueContainer(u,r);if(a||o["@list"]){if((a&&!Array.isArray(o)&&!o["@list"]||o["@list"]&&!Array.isArray(o["@list"]))&&f!==e.rdfNil){const r=e.dataFactory.blankNode();t.emitQuad(l,e.dataFactory.quad(r,e.rdfRest,e.rdfNil,e.getDefaultGraph())),t.emitQuad(l,e.dataFactory.quad(r,e.rdfFirst,f,e.getDefaultGraph())),f=r}if(d&&!t.allowSubjectList)throw new i.ErrorCoded(`Found illegal list value in subject position at ${r}`,i.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}}await a.handlePredicateObject(t,e,s,l,h,f,d)}}}}e.EntryHandlerPredicate=a},479:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeyword=void 0,e.EntryHandlerKeyword=class{constructor(t){this.keyword=t}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,i,n){return!1}async test(t,e,r,i,n){return r===this.keyword}}},613:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordContext=void 0;const i=r(288),n=r(479);class a extends n.EntryHandlerKeyword{constructor(){super("@context")}isStackProcessor(){return!1}async handle(t,e,r,n,a,s){t.streamingProfile&&(t.processingStack[s]||t.processingType[s]||void 0!==t.idStack[s])&&t.emitError(new i.ErrorCoded("Found an out-of-order context, while streaming is enabled.(disable `streamingProfile`)",i.ERROR_CODES.INVALID_STREAMING_KEY_ORDER));const o=t.getContext(n),l=t.parseContext(a,(await o).getContextRaw());t.contextTree.setContext(n.slice(0,-1),l),t.emitContext(a),await t.validateContext(await l)}}e.EntryHandlerKeywordContext=a},330:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordGraph=void 0;const i=r(479);class n extends i.EntryHandlerKeyword{constructor(){super("@graph")}async handle(t,e,r,i,n,a){t.graphStack[a+1]=!0}}e.EntryHandlerKeywordGraph=n},709:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordId=void 0;const i=r(288),n=r(479);class a extends n.EntryHandlerKeyword{constructor(){super("@id")}isStackProcessor(){return!1}async handle(t,e,r,n,a,s){"string"!=typeof a&&t.emitError(new i.ErrorCoded(`Found illegal @id '${a}'`,i.ERROR_CODES.INVALID_ID_VALUE));const o=await e.getPropertiesDepth(n,s);void 0!==t.idStack[o]&&(t.idStack[o][0].listHead?t.emitError(new i.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${n[s-1]}'`,i.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT)):t.emitError(new i.ErrorCoded(`Found duplicate @ids '${t.idStack[o][0].value}' and '${a}'`,i.ERROR_CODES.COLLIDING_KEYWORDS))),t.idStack[o]=e.nullableTermToArray(await e.resourceToTerm(await t.getContext(n),a))}}e.EntryHandlerKeywordId=a},406:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordIncluded=void 0;const i=r(288),n=r(479);class a extends n.EntryHandlerKeyword{constructor(){super("@included")}async handle(t,e,r,n,a,s){"object"!=typeof a&&t.emitError(new i.ErrorCoded(`Found illegal @included '${a}'`,i.ERROR_CODES.INVALID_INCLUDED_VALUE));const o=await e.unaliasKeywords(a,n,s,await t.getContext(n));"@value"in o&&t.emitError(new i.ErrorCoded(`Found an illegal @included @value node '${JSON.stringify(a)}'`,i.ERROR_CODES.INVALID_INCLUDED_VALUE)),"@list"in o&&t.emitError(new i.ErrorCoded(`Found an illegal @included @list node '${JSON.stringify(a)}'`,i.ERROR_CODES.INVALID_INCLUDED_VALUE)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordIncluded=a},323:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordNest=void 0;const i=r(288),n=r(479);class a extends n.EntryHandlerKeyword{constructor(){super("@nest")}async handle(t,e,r,n,a,s){"object"!=typeof a&&t.emitError(new i.ErrorCoded(`Found invalid @nest entry for '${r}': '${a}'`,i.ERROR_CODES.INVALID_NEST_VALUE)),"@value"in await e.unaliasKeywords(a,n,s,await t.getContext(n))&&t.emitError(new i.ErrorCoded(`Found an invalid @value node for '${r}'`,i.ERROR_CODES.INVALID_NEST_VALUE)),t.emittedStack[s]=!1}}e.EntryHandlerKeywordNest=a},820:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordType=void 0;const i=r(288),n=r(754),a=r(488),s=r(479);class o extends s.EntryHandlerKeyword{constructor(){super("@type")}isStackProcessor(){return!1}async handle(t,e,r,s,o,l){const d=s[l],c=await t.getContext(s),u=e.rdfType,h=n.Util.isPropertyReverse(c,d,await e.unaliasKeywordParent(s,l)),f=Array.isArray(o)?o:[o];for(const r of f){"string"!=typeof r&&t.emitError(new i.ErrorCoded(`Found illegal @type '${r}'`,i.ERROR_CODES.INVALID_TYPE_VALUE));const n=e.createVocabOrBaseTerm(c,r);n&&await a.EntryHandlerPredicate.handlePredicateObject(t,e,s,l,u,n,h)}let p=Promise.resolve(c),g=!1;for(const e of f.sort()){const r=n.Util.getContextValue(c,"@context",e,null);r&&(g=!0,p=p.then((e=>t.parseContext(r,e.getContextRaw()))))}!t.streamingProfile||!g&&t.streamingProfileAllowOutOfOrderPlainType||!t.processingStack[l]&&!t.idStack[l]||t.emitError(new i.ErrorCoded("Found an out-of-order type-scoped context, while streaming is enabled.(disable `streamingProfile`)",i.ERROR_CODES.INVALID_STREAMING_KEY_ORDER)),g&&(p=p.then((t=>("@propagate"in t.getContextRaw()||(t.getContextRaw()["@propagate"]=!1),!1===t.getContextRaw()["@propagate"]&&(t.getContextRaw()["@__propagateFallback"]=c.getContextRaw()),t))),t.contextTree.setContext(s.slice(0,s.length-1),p)),t.processingType[l]=!0}}e.EntryHandlerKeywordType=o},963:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordUnknownFallback=void 0;const i=r(288);class n{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(t,e,r,n,a){const s=await e.unaliasKeyword(r[n],r,n);return!(!i.Util.isPotentialKeyword(s)||!a&&"@list"===s)}async test(t,e,r,n,a){return i.Util.isPotentialKeyword(r)}async handle(t,e,r,a,s,o){const l=n.VALID_KEYWORDS_TYPES[r];void 0!==l?l&&typeof s!==l.type&&t.emitError(new i.ErrorCoded(`Invalid value type for '${r}' with value '${s}'`,l.errorCode)):t.strictValues&&t.emitError(new Error(`Unknown keyword '${r}' with value '${s}'`)),t.emittedStack[o]=!1}}e.EntryHandlerKeywordUnknownFallback=n,n.VALID_KEYWORDS_TYPES={"@index":{type:"string",errorCode:i.ERROR_CODES.INVALID_INDEX_VALUE},"@list":null,"@reverse":{type:"object",errorCode:i.ERROR_CODES.INVALID_REVERSE_VALUE},"@set":null,"@value":null}},322:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EntryHandlerKeywordValue=void 0;const i=r(479);class n extends i.EntryHandlerKeyword{constructor(){super("@value")}async test(t,e,r,i,n){return"@value"===await e.unaliasKeyword(i[n],i.slice(0,i.length-1),n-1,!0)}async handle(t,e,r,i,n,a){t.literalStack[a]=!0,delete t.unidentifiedValuesBuffer[a],delete t.unidentifiedGraphsBuffer[a],t.emittedStack[a]=!1}}e.EntryHandlerKeywordValue=n},222:t=>{var e={},r=e.LEFT_BRACE=1,i=e.RIGHT_BRACE=2,n=e.LEFT_BRACKET=3,a=e.RIGHT_BRACKET=4,s=e.COLON=5,o=e.COMMA=6,l=e.TRUE=7,d=e.FALSE=8,c=e.NULL=9,u=e.STRING=10,h=e.NUMBER=11,f=e.START=17,p=e.STOP=18,g=e.TRUE1=33,y=e.TRUE2=34,E=e.TRUE3=35,C=e.FALSE1=49,w=e.FALSE2=50,_=e.FALSE3=51,I=e.FALSE4=52,R=e.NULL1=65,O=e.NULL2=66,x=e.NULL3=67,b=e.NUMBER1=81,v=e.NUMBER3=83,m=e.STRING1=97,S=e.STRING2=98,N=e.STRING3=99,T=e.STRING4=100,A=e.STRING5=101,D=e.STRING6=102,L=e.VALUE=113,P=e.KEY=114,V=e.OBJECT=129,k=e.ARRAY=130,U="\\".charCodeAt(0),j="/".charCodeAt(0),F="\b".charCodeAt(0),G="\f".charCodeAt(0),B="\n".charCodeAt(0),M="\r".charCodeAt(0),$="\t".charCodeAt(0),K=65536;function J(){this.tState=f,this.value=void 0,this.string=void 0,this.stringBuffer=Buffer.alloc?Buffer.alloc(K):new Buffer(K),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=L,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.offset=-1}J.toknam=function(t){for(var r=Object.keys(e),i=0,n=r.length;i<n;i++){var a=r[i];if(e[a]===t)return a}return t&&"0x"+t.toString(16)};var H=J.prototype;H.onError=function(t){throw t},H.charError=function(t,e){this.tState=p,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+J.toknam(this.tState)))},H.appendStringChar=function(t){this.stringBufferOffset>=K&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=t},H.appendStringBuf=function(t,e,r){var i=t.length;"number"==typeof e&&(i="number"==typeof r?r<0?t.length-e+r:r-e:t.length-e),i<0&&(i=0),this.stringBufferOffset+i>K&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),t.copy(this.stringBuffer,this.stringBufferOffset,e,r),this.stringBufferOffset+=i},H.write=function(t){var e;"string"==typeof t&&(t=new Buffer(t));for(var p=0,L=t.length;p<L;p++)if(this.tState===f){if(e=t[p],this.offset++,123===e)this.onToken(r,"{");else if(125===e)this.onToken(i,"}");else if(91===e)this.onToken(n,"[");else if(93===e)this.onToken(a,"]");else if(58===e)this.onToken(s,":");else if(44===e)this.onToken(o,",");else if(116===e)this.tState=g;else if(102===e)this.tState=C;else if(110===e)this.tState=R;else if(34===e)this.string="",this.stringBufferOffset=0,this.tState=m;else if(45===e)this.string="-",this.tState=b;else if(e>=48&&e<64)this.string=String.fromCharCode(e),this.tState=v;else if(32!==e&&9!==e&&10!==e&&13!==e)return this.charError(t,p)}else if(this.tState===m)if(e=t[p],this.bytes_remaining>0){for(var P=0;P<this.bytes_remaining;P++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+P]=t[P];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,p=p+P-1}else if(0===this.bytes_remaining&&e>=128){if(e<=193||e>244)return this.onError(new Error("Invalid UTF-8 character at position "+p+" in state "+J.toknam(this.tState)));if(e>=194&&e<=223&&(this.bytes_in_sequence=2),e>=224&&e<=239&&(this.bytes_in_sequence=3),e>=240&&e<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+p>t.length){for(var V=0;V<=t.length-1-p;V++)this.temp_buffs[this.bytes_in_sequence][V]=t[p+V];this.bytes_remaining=p+this.bytes_in_sequence-t.length,p=t.length-1}else this.appendStringBuf(t,p,p+this.bytes_in_sequence),p=p+this.bytes_in_sequence-1}else if(34===e)this.tState=f,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(u,this.string),this.offset+=Buffer.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===e)this.tState=S;else{if(!(e>=32))return this.charError(t,p);this.appendStringChar(e)}else if(this.tState===S)if(34===(e=t[p]))this.appendStringChar(e),this.tState=m;else if(92===e)this.appendStringChar(U),this.tState=m;else if(47===e)this.appendStringChar(j),this.tState=m;else if(98===e)this.appendStringChar(F),this.tState=m;else if(102===e)this.appendStringChar(G),this.tState=m;else if(110===e)this.appendStringChar(B),this.tState=m;else if(114===e)this.appendStringChar(M),this.tState=m;else if(116===e)this.appendStringChar($),this.tState=m;else{if(117!==e)return this.charError(t,p);this.unicode="",this.tState=N}else if(this.tState===N||this.tState===T||this.tState===A||this.tState===D){if(!((e=t[p])>=48&&e<64||e>64&&e<=70||e>96&&e<=102))return this.charError(t,p);if(this.unicode+=String.fromCharCode(e),this.tState++===D){var k=parseInt(this.unicode,16);this.unicode=void 0,void 0!==this.highSurrogate&&k>=56320&&k<57344?(this.appendStringBuf(new Buffer(String.fromCharCode(this.highSurrogate,k))),this.highSurrogate=void 0):void 0===this.highSurrogate&&k>=55296&&k<56320?this.highSurrogate=k:(void 0!==this.highSurrogate&&(this.appendStringBuf(new Buffer(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new Buffer(String.fromCharCode(k)))),this.tState=m}}else if(this.tState===b||this.tState===v)switch(e=t[p]){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(e),this.tState=v;break;default:this.tState=f;var K=Number(this.string);if(isNaN(K))return this.charError(t,p);this.string.match(/[0-9]+/)==this.string&&K.toString()!=this.string?this.onToken(u,this.string):this.onToken(h,K),this.offset+=this.string.length-1,this.string=void 0,p--}else if(this.tState===g){if(114!==t[p])return this.charError(t,p);this.tState=y}else if(this.tState===y){if(117!==t[p])return this.charError(t,p);this.tState=E}else if(this.tState===E){if(101!==t[p])return this.charError(t,p);this.tState=f,this.onToken(l,!0),this.offset+=3}else if(this.tState===C){if(97!==t[p])return this.charError(t,p);this.tState=w}else if(this.tState===w){if(108!==t[p])return this.charError(t,p);this.tState=_}else if(this.tState===_){if(115!==t[p])return this.charError(t,p);this.tState=I}else if(this.tState===I){if(101!==t[p])return this.charError(t,p);this.tState=f,this.onToken(d,!1),this.offset+=4}else if(this.tState===R){if(117!==t[p])return this.charError(t,p);this.tState=O}else if(this.tState===O){if(108!==t[p])return this.charError(t,p);this.tState=x}else if(this.tState===x){if(108!==t[p])return this.charError(t,p);this.tState=f,this.onToken(c,null),this.offset+=3}},H.onToken=function(t,e){},H.parseError=function(t,e){this.tState=p,this.onError(new Error("Unexpected "+J.toknam(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+J.toknam(this.state)))},H.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},H.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=L)},H.emit=function(t){this.mode&&(this.state=o),this.onValue(t)},H.onValue=function(t){},H.onToken=function(t,e){if(this.state===L)if(t===u||t===h||t===l||t===d||t===c)this.value&&(this.value[this.key]=e),this.emit(e);else if(t===r)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=P,this.mode=V;else if(t===n)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=k,this.state=L;else if(t===i){if(this.mode!==V)return this.parseError(t,e);this.pop()}else{if(t!==a)return this.parseError(t,e);if(this.mode!==k)return this.parseError(t,e);this.pop()}else if(this.state===P)if(t===u)this.key=e,this.state=s;else{if(t!==i)return this.parseError(t,e);this.pop()}else if(this.state===s){if(t!==s)return this.parseError(t,e);this.state=L}else{if(this.state!==o)return this.parseError(t,e);if(t===o)this.mode===k?(this.key++,this.state=L):this.mode===V&&(this.state=P);else{if(!(t===a&&this.mode===k||t===i&&this.mode===V))return this.parseError(t,e);this.pop()}}},J.C=e,t.exports=J},640:function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||i(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(r(970),e),n(r(498),e),n(r(381),e),n(r(808),e),n(r(16),e),n(r(387),e),n(r(573),e)},970:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlankNode=void 0,e.BlankNode=class{constructor(t){this.termType="BlankNode",this.value=t}equals(t){return!!t&&"BlankNode"===t.termType&&t.value===this.value}}},498:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataFactory=void 0;const i=r(970),n=r(381),a=r(808),s=r(16),o=r(387),l=r(573);let d=0;e.DataFactory=class{constructor(t){this.blankNodeCounter=0,t=t||{},this.blankNodePrefix=t.blankNodePrefix||`df_${d++}_`}namedNode(t){return new s.NamedNode(t)}blankNode(t){return new i.BlankNode(t||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(t,e){return new a.Literal(t,e)}variable(t){return new l.Variable(t)}defaultGraph(){return n.DefaultGraph.INSTANCE}quad(t,e,r,i){return new o.Quad(t,e,r,i||this.defaultGraph())}fromTerm(t){switch(t.termType){case"NamedNode":return this.namedNode(t.value);case"BlankNode":return this.blankNode(t.value);case"Literal":return t.language?this.literal(t.value,t.language):t.datatype.equals(a.Literal.XSD_STRING)?this.literal(t.value):this.literal(t.value,this.fromTerm(t.datatype));case"Variable":return this.variable(t.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(t.subject),this.fromTerm(t.predicate),this.fromTerm(t.object),this.fromTerm(t.graph))}}fromQuad(t){return this.fromTerm(t)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},381:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultGraph=void 0;class r{constructor(){this.termType="DefaultGraph",this.value=""}equals(t){return!!t&&"DefaultGraph"===t.termType}}e.DefaultGraph=r,r.INSTANCE=new r},808:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Literal=void 0;const i=r(16);class n{constructor(t,e){this.termType="Literal",this.value=t,"string"==typeof e?(this.language=e,this.datatype=n.RDF_LANGUAGE_STRING):e?(this.language="",this.datatype=e):(this.language="",this.datatype=n.XSD_STRING)}equals(t){return!!t&&"Literal"===t.termType&&t.value===this.value&&t.language===this.language&&t.datatype.equals(this.datatype)}}e.Literal=n,n.RDF_LANGUAGE_STRING=new i.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),n.XSD_STRING=new i.NamedNode("http://www.w3.org/2001/XMLSchema#string")},16:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NamedNode=void 0,e.NamedNode=class{constructor(t){this.termType="NamedNode",this.value=t}equals(t){return!!t&&"NamedNode"===t.termType&&t.value===this.value}}},387:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quad=void 0,e.Quad=class{constructor(t,e,r,i){this.termType="Quad",this.value="",this.subject=t,this.predicate=e,this.object=r,this.graph=i}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&this.subject.equals(t.subject)&&this.predicate.equals(t.predicate)&&this.object.equals(t.object)&&this.graph.equals(t.graph)}}},573:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Variable=void 0,e.Variable=class{constructor(t){this.termType="Variable",this.value=t}equals(t){return!!t&&"Variable"===t.termType&&t.value===this.value}}},912:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(336))},336:(t,e)=>{"use strict";function r(t){const e=[];let r=0;for(;r<t.length;)switch(t[r]){case"/":if("."===t[r+1])if("."===t[r+2]){if(!n(t[r+3])){e.push([]),r++;break}e.pop(),t[r+3]||e.push([]),r+=3}else{if(!n(t[r+2])){e.push([]),r++;break}t[r+2]||e.push([]),r+=2}else e.push([]),r++;break;case"#":case"?":e.length||e.push([]),e[e.length-1].push(t.substr(r)),r=t.length;break;default:e.length||e.push([]),e[e.length-1].push(t[r]),r++}return"/"+e.map((t=>t.join(""))).join("/")}function i(t,e){let i=e+1;e>=0?"/"===t[e+1]&&"/"===t[e+2]&&(i=e+3):"/"===t[0]&&"/"===t[1]&&(i=2);const n=t.indexOf("/",i);return n<0?t:t.substr(0,n)+r(t.substr(n))}function n(t){return!t||"#"===t||"?"===t||"/"===t}Object.defineProperty(e,"__esModule",{value:!0}),e.resolve=function(t,e){const n=(e=e||"").indexOf("#");if(n>0&&(e=e.substr(0,n)),!t.length){if(e.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${e}' for value '${t}'`);return e}if(t.startsWith("?")){const r=e.indexOf("?");return r>0&&(e=e.substr(0,r)),e+t}if(t.startsWith("#"))return e+t;if(!e.length){const e=t.indexOf(":");if(e<0)throw new Error(`Found invalid relative IRI '${t}' for a missing baseIRI`);return i(t,e)}const a=t.indexOf(":");if(a>=0)return i(t,a);const s=e.indexOf(":");if(s<0)throw new Error(`Found invalid baseIRI '${e}' for value '${t}'`);const o=e.substr(0,s+1);if(0===t.indexOf("//"))return o+i(t,a);let l;if(e.indexOf("//",s)===s+1){if(l=e.indexOf("/",s+3),l<0)return e.length>s+3?e+"/"+i(t,a):o+i(t,a)}else if(l=e.indexOf("/",s+1),l<0)return o+i(t,a);if(0===t.indexOf("/"))return e.substr(0,l)+r(t);let d=e.substr(l);const c=d.lastIndexOf("/");return c>=0&&c<d.length-1&&(d=d.substr(0,c+1),"."===t[0]&&"."!==t[1]&&"/"!==t[1]&&t[2]&&(t=t.substr(1))),t=r(t=d+t),e.substr(0,l)+t},e.removeDotSegments=r,e.removeDotSegmentsOfPath=i},86:(t,e,r)=>{var i=r(624);function n(){i.call(this)}n.prototype=new i,t.exports=n,n.Stream=n,n.prototype.pipe=function(t,e){var r=this;function i(e){t.writable&&!1===t.write(e)&&r.pause&&r.pause()}function n(){r.readable&&r.resume&&r.resume()}r.on("data",i),t.on("drain",n),t._isStdio||e&&!1===e.end||(r.on("end",s),r.on("close",o));var a=!1;function s(){a||(a=!0,t.end())}function o(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function l(t){if(d(),!this.hasListeners("error"))throw t}function d(){r.off("data",i),t.off("drain",n),r.off("end",s),r.off("close",o),r.off("error",l),t.off("error",l),r.off("end",d),r.off("close",d),t.off("end",d),t.off("close",d)}return r.on("error",l),t.on("error",l),r.on("end",d),r.on("close",d),t.on("end",d),t.on("close",d),t.emit("pipe",r),t}}},e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={exports:{}};return t[i].call(n.exports,n,n.exports,r),n.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=new(r(758).JsonLdParser);t.on("data",console.log).on("error",console.error).on("end",(()=>console.log("All triples were parsed!"))),t.write("{"),t.write('"@context": "https://schema.org/",'),t.write('"@type": "Recipe",'),t.write('"name": "Grandma\'s Holiday Apple Pie",'),t.write('"aggregateRating": {'),t.write('"@type": "AggregateRating",'),t.write('"ratingValue": "4"'),t.write("}}"),t.end()})()})();